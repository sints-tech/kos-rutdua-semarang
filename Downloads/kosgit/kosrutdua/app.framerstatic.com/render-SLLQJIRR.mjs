import{a as ol}from"https://app.framerstatic.com/chunk-QBY2M5HG.mjs";import"https://app.framerstatic.com/chunk-I4MGWFOQ.mjs";import{a as ot}from"https://app.framerstatic.com/chunk-R67VYHHT.mjs";import{a as $s}from"https://app.framerstatic.com/chunk-F6ABH7PM.mjs";import{a as qo,b as el,c as tl}from"https://app.framerstatic.com/chunk-HLQFPTOD.mjs";import"https://app.framerstatic.com/chunk-XOHSX3RM.mjs";import"https://app.framerstatic.com/chunk-AF4IAENG.mjs";import"https://app.framerstatic.com/chunk-I3A6UFJR.mjs";import"https://app.framerstatic.com/chunk-Q4ZQNAWB.mjs";import{$c as Gs,Ac as As,B as Vo,Dc as Kn,Ec as Rs,Kc as eo,Mc as Xn,Oc as Ds,Pb as Is,Pc as Ms,Tb as bs,Tc as _s,Ua as us,Ub as qn,Uc as Tt,Vb as Fs,Wb as Ss,Wc as Vs,Xb as vs,Ya as gs,Yb as Ln,a as Ao,b as ts,c as os,dd as zs,e as ns,ed as Ws,fd as qs,g as rs,h as is,hc as Ps,hd as Ls,ic as Es,id as Ks,jc as ks,jd as Xs,lb as ys,lc as Ns,m as Ro,mc as Os,md as Zs,n as as,nc as Bs,nd as js,o as Do,od as zo,pd as Wo,q as Mo,qb as hs,r as _o,s as ss,sd as R,tb as Cs,u as ls,ud as Ys,va as zn,vd as Hs,w as cs,x as fs,xd as Js,y as ds,ya as Wn,yd as Qs,zc as Ts}from"https://app.framerstatic.com/chunk-TTFL62JC.mjs";import"https://app.framerstatic.com/chunk-ZZ6IHUC3.mjs";import"https://app.framerstatic.com/chunk-NMGVY23D.mjs";import{a as Te}from"https://app.framerstatic.com/chunk-37BOALED.mjs";import"https://app.framerstatic.com/chunk-JSOI5ZKD.mjs";import{h as es}from"https://app.framerstatic.com/chunk-5LL2TI3J.mjs";import{D as qa}from"https://app.framerstatic.com/chunk-OID4SSFH.mjs";import"https://app.framerstatic.com/chunk-CAYX5SA5.mjs";import"https://app.framerstatic.com/chunk-IHOAENGB.mjs";import{A as Nt,Aa as _a,C as T,Db as Za,E as Ia,F as Sa,G as va,H as ko,I as No,J as Pa,K as Ea,L as ka,M as Ot,O as Oo,P as Bo,Y as Oa,ea as Ba,pa as Ta,ub as Ga,vb as za,wb as Wa,xa as Ma,xb as Ka,ya as To,z as kt}from"https://app.framerstatic.com/chunk-6M6DEEG6.mjs";import{a as Da,b as La,e as Xa}from"https://app.framerstatic.com/chunk-BY4UT6YX.mjs";import{Hd as Ua,Xa as ga,cb as ha,da,ga as I,ha as pa,id as xa,mb as Ca,wf as Na}from"https://app.framerstatic.com/chunk-G2SVSL52.mjs";import"https://app.framerstatic.com/chunk-UHSP26DM.mjs";import{a as ma}from"https://app.framerstatic.com/chunk-3TJANG4N.mjs";import{j as wa}from"https://app.framerstatic.com/chunk-P7XPDU7P.mjs";import"https://app.framerstatic.com/chunk-BQK5PZHM.mjs";import"https://app.framerstatic.com/chunk-I3QG7GSD.mjs";import"https://app.framerstatic.com/chunk-JRBFLTNY.mjs";import"https://app.framerstatic.com/chunk-N57XNHE3.mjs";import"https://app.framerstatic.com/chunk-DMAKRWWX.mjs";import"https://app.framerstatic.com/chunk-4QYPAPBC.mjs";import"https://app.framerstatic.com/chunk-SE354WOV.mjs";import{i as ba,j as Fa}from"https://app.framerstatic.com/chunk-JB3A7NVR.mjs";import"https://app.framerstatic.com/chunk-HTH46QE2.mjs";import"https://app.framerstatic.com/chunk-FL6OWCOC.mjs";import"https://app.framerstatic.com/chunk-PQSVGIFC.mjs";import"https://app.framerstatic.com/chunk-WAFDZ45U.mjs";import"https://app.framerstatic.com/chunk-CEAD3TDP.mjs";import"https://app.framerstatic.com/chunk-QFY6U4LN.mjs";import"https://app.framerstatic.com/chunk-YE25YANI.mjs";import"https://app.framerstatic.com/chunk-DHKKT45Z.mjs";import"https://app.framerstatic.com/chunk-GCZE4SS7.mjs";import{a as Bt}from"https://app.framerstatic.com/chunk-5VYR77I7.mjs";import"https://app.framerstatic.com/chunk-EWEZCJKH.mjs";import{a as $a}from"https://app.framerstatic.com/chunk-OCSSTRTE.mjs";import{a as ua,b as ft}from"https://app.framerstatic.com/chunk-JU6ZA2PL.mjs";import{b as ps}from"https://app.framerstatic.com/chunk-X74LP56K.mjs";import"https://app.framerstatic.com/chunk-JJRD4SPC.mjs";import"https://app.framerstatic.com/chunk-D7MEQ7Y3.mjs";import{i as fa}from"https://app.framerstatic.com/chunk-4AKWN7KV.mjs";import"https://app.framerstatic.com/chunk-D3O6H5GO.mjs";import"https://app.framerstatic.com/chunk-YS3B4HMG.mjs";import{a as xs,d as Us}from"https://app.framerstatic.com/chunk-MMRW4ZOW.mjs";import"https://app.framerstatic.com/chunk-GTMRROB6.mjs";import"https://app.framerstatic.com/chunk-F7V7DNCL.mjs";import"https://app.framerstatic.com/chunk-Q6FTMIL5.mjs";import"https://app.framerstatic.com/chunk-NHENQ4BH.mjs";import{a as tt}from"https://app.framerstatic.com/chunk-7GSEC7H4.mjs";import"https://app.framerstatic.com/chunk-PEHHZ72T.mjs";import"https://app.framerstatic.com/chunk-M7F4BWXH.mjs";import{a as ms}from"https://app.framerstatic.com/chunk-WUHYMOND.mjs";import{a as Qa}from"https://app.framerstatic.com/chunk-L5BCEPO4.mjs";import{b as Ra,r as Va}from"https://app.framerstatic.com/chunk-CFPWEMX5.mjs";import{e as $t,f as Aa}from"https://app.framerstatic.com/chunk-5ZPLZ5Y5.mjs";import{a as ya,j as oe}from"https://app.framerstatic.com/chunk-NWXZUV7M.mjs";import"https://app.framerstatic.com/chunk-PABHF7FN.mjs";import{$d as Ti,Dg as Ri,Eg as Di,Hd as Vn,Ia as vo,Id as Gn,Pb as bi,Sg as Mi,Vc as vi,Xb as Fi,Zd as Oi,_d as Bi,ae as Ai,dd as Pi,ed as B,ja as _n,rd as ki,sd as Ni,vc as Si}from"https://app.framerstatic.com/chunk-N6T5M2U2.mjs";import"https://app.framerstatic.com/chunk-MTCSGQFI.mjs";import"https://app.framerstatic.com/chunk-XFNBDXCA.mjs";import{e as Ei,f as Be}from"https://app.framerstatic.com/chunk-JRE74LV4.mjs";import"https://app.framerstatic.com/chunk-Y4KSD2WZ.mjs";import"https://app.framerstatic.com/chunk-CGTZJUPQ.mjs";import{b as ws}from"https://app.framerstatic.com/chunk-GHQIQB74.mjs";import"https://app.framerstatic.com/chunk-53F76R4B.mjs";import"https://app.framerstatic.com/chunk-WKRIJFLD.mjs";import{Af as vt,Be as G,Bf as Pt,Cf as Et,Dg as ca,Ef as Eo,He as Le,I as qi,Lc as Zi,Le as Hi,Oe as Ji,Of as ra,P as Li,Qe as Qi,Ye as Po,af as $i,b as Gi,bf as ea,cb as Ki,cf as ta,h as zi,ig as ia,jg as aa,l as Wi,lb as Xi,ng as sa,oe as ji,og as la,ue as Yi,ve as he,vf as oa,wf as na}from"https://app.framerstatic.com/chunk-MJU7MCEH.mjs";import{a as Go}from"https://app.framerstatic.com/chunk-755KSJY3.mjs";import"https://app.framerstatic.com/chunk-NC7G7GJK.mjs";import"https://app.framerstatic.com/chunk-PKXMCYET.mjs";import"https://app.framerstatic.com/chunk-IYBTX7V5.mjs";import"https://app.framerstatic.com/chunk-L5MLGJZF.mjs";import{a as Ya}from"https://app.framerstatic.com/chunk-O5ZLAZAH.mjs";import{a as X}from"https://app.framerstatic.com/chunk-QFU6OGL3.mjs";import{a as ja,b as Ha,c as Ja}from"https://app.framerstatic.com/chunk-CTKJD4ES.mjs";import"https://app.framerstatic.com/chunk-LM2ZSXH3.mjs";import{Ed as Ii,bf as So,lc as K,tb as wi}from"https://app.framerstatic.com/chunk-EBH5X5S4.mjs";import{$k as yo,Aq as et,B as Je,Bd as ii,Bq as Ci,Cb as Qr,Cq as wo,Ee as ai,Eq as xo,Fe as si,G as We,Gd as P,Hd as be,Kd as Ft,Lc as oi,Ld as qe,Lp as Rn,N as ke,Nc as uo,Nm as mi,Op as Dn,Pc as Oe,Pk as An,Pu as Mn,Ql as ho,Qq as Uo,Rq as Io,Sl as ct,Sq as bo,Tc as go,Tq as Fo,Wn as ui,Xl as Co,Xn as gi,bc as $r,bl as fi,cc as ei,dc as ti,dd as ni,di as li,ec as O,ev as xi,jv as Ui,kb as Yr,kq as hi,l as Q,la as Ie,mb as Hr,ni as ci,qm as di,rn as pi,vd as ri,xd as Tn,xu as St,zr as Qt}from"https://app.framerstatic.com/chunk-WDCEA3EQ.mjs";import"https://app.framerstatic.com/chunk-VXJAAVJQ.mjs";import"https://app.framerstatic.com/chunk-KD4H3DLZ.mjs";import{f as yi}from"https://app.framerstatic.com/chunk-5DSVU7DA.mjs";import"https://app.framerstatic.com/chunk-4DUBS6C5.mjs";import"https://app.framerstatic.com/chunk-XFC6OVIX.mjs";import"https://app.framerstatic.com/chunk-2C4FJUEI.mjs";import"https://app.framerstatic.com/chunk-XFC6OVIX.mjs";import"https://app.framerstatic.com/chunk-LH43QRIB.mjs";import{a as A,b as Gr}from"https://app.framerstatic.com/chunk-4AQCMAAQ.mjs";import"https://app.framerstatic.com/chunk-FI7WGJHP.mjs";import{c as zr}from"https://app.framerstatic.com/chunk-SSXQNR5C.mjs";import"https://app.framerstatic.com/chunk-4ZPMQ7AD.mjs";import"https://app.framerstatic.com/chunk-POQKH4YA.mjs";import{e as _i,g as Vi,i as te}from"https://app.framerstatic.com/chunk-3PGDFP4U.mjs";import"https://app.framerstatic.com/chunk-AUNF3KWQ.mjs";import{k as Wr,t as qr,u as Lr}from"https://app.framerstatic.com/chunk-XFCQREKZ.mjs";import{p as $e,q as Jr,r as bt}from"https://app.framerstatic.com/chunk-3DFADFT7.mjs";import{b as ae,d as Xr,e as Qe,f as po,i as se,m as Zr,o as jr}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{Vc as Ne,a as L,b as x,sc as Kr}from"https://app.framerstatic.com/chunk-NOOQGO4X.mjs";import"https://app.framerstatic.com/chunk-4CB4BQFV.mjs";import{b as Vr}from"https://app.framerstatic.com/chunk-ORIFM75E.mjs";import"https://app.framerstatic.com/chunk-66XIMNKS.mjs";import{D as _r,ba as Jt,ca as It,i as co,l as ee,p as fo}from"https://app.framerstatic.com/chunk-IZV4HDYJ.mjs";import{a as u,b as Ht}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as mo}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{e as g,f as je,g as Ye,h as M,i as ie,j as h,k as He,l as J,m as Yt}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var rl=g(x()),Hf={BooleanControlPropRow:qo,EnumControlPropRow:Ts,StringControlPropRow:eo};function nl({children:o}){return(0,rl.jsx)(hs.Provider,{value:Hf,children:o})}var Zn="data-chrome";function il(o){return o instanceof HTMLElement?o.closest(`[${Zn}]`)!==null:!1}var jn="data-floating-canvas-chrome";function al(o){return o instanceof Element?o.closest(`[${jn}]`)!==null:!1}function sl(){return window}function Yn(){return sl().secureFrameAncestors}function At(){A(Yn(),"Must have secure frame ancestors.")}var cn=g(L());var ll="chromeHidden_c1gxt05z",cl="nonHudChromeWrapper_n1sd5akc";var Rt=g(L());var Hn=g(x());function fl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=B(),l=n.getPropertyControls(s.tree)[t];return A(l?.type==="boolean"),(0,Hn.jsx)(R,{title:l.title??"",warningMessage:r,children:(0,Hn.jsx)(Vs,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:m=>{oe(m)&&i(t,m)}})})}var dl="onPageCMSFieldsModal_o1kosemn",ml="onPageCMSFieldsModalHeader_o1tcokht",pl="onPageCMSFieldsModalBody_o11jr4ka",Qf=1,ul=te.panelPadding+Qf,gl="onPageCMSFieldsModalButtonContainer_oaqx903",Lo="button_b1gqim6f";var yl="wrapper_wje69dc",hl="input_i1rqgchl",Cl="icon_ixghur2",wl="collectionInputHeight_c1d0unc6";var Jn=g(x());function xl({collectionNode:o,controlProp:n,variableId:e,warningMessage:t,onChange:r}){let i=B(),c=o.getPropertyControls(i.tree)[e];A(c?.type==="collectionreference");let l=ui(c,n);A(!O(l),"Variables are not supported");let m=c.dataIdentifier;function p(d){r(e,{type:"collectionreference",value:d})}return(0,Jn.jsx)(R,{title:c.title??"",warningMessage:t,children:(0,Jn.jsx)(Is,{large:!0,value:l,onChange:p,className:hl,dataIdentifier:m,wrapperClassName:Yr(yl,wl),iconClassName:Cl})})}var Qn=g(x());function Ul({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=B(),l=n.getPropertyControls(s.tree)[t];return A(l?.type==="color"),(0,Qn.jsx)(R,{title:l.title??"",warningMessage:r,children:(0,Qn.jsx)(zs,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:m=>{oe(m)&&i(t,m)},ColorPickerPopoutComponent:ys})})}var $n=g(x());function Il({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=B(),l=n.getPropertyControls(s.tree)[t];return A(l?.type==="date"),(0,$n.jsx)(R,{title:l.title??"",warningMessage:r,children:(0,$n.jsx)(Ws,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:m=>{oe(m)&&i(t,m)},required:!1})})}var er=g(x());function bl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=B(),l=n.getPropertyControls(s.tree)[t];return A(l?.type==="enum"),(0,er.jsx)(R,{title:l.title??"",warningMessage:r,children:(0,er.jsx)(qs,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:m=>{oe(m)&&i(t,m)}})})}var tr=g(x());function Fl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=B(),l=n.getPropertyControls(s.tree)[t];if(A(l?.type==="file"),A(!Oe(e?.value),"Dynamic values are not supported within required field validation"),e&&e?.type!=="file")return null;let p=(e?.value??"").split(".").pop(),d=!p||l.allowedFileTypes.length===0||l.allowedFileTypes.includes(p);return(0,tr.jsx)(R,{title:l.title??"",warningMessage:r,showWarningTint:!d,children:(0,tr.jsx)(Ls,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:f=>{oe(f)&&i(t,f)},reset:()=>{i(t,{type:"file",value:void 0})}})})}var or=g(x());function Sl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,onChange:r}){let i=B(),s=$a(a=>{let w=a(e);w&&r(t,w)}),l=n.getPropertyControls(i.tree)[t];A(l?.type==="array"),A(!e||ci(e));let m=ss(e,l,!0),p=ls(e,l,!0),f=_o(m??p,l);return(0,or.jsx)(R,{title:l.title??"",warningMessage:f,children:(0,or.jsx)(Ks,{collectionId:n.id,control:l,fieldId:t,controlProp:e,itemId:o.id,onChange:s,required:!1})})}var nr=g(x());function vl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=B(),l=n.getPropertyControls(s.tree)[t];return A(l?.type==="responsiveimage"),(0,nr.jsx)(R,{title:l.title??"",warningMessage:r,children:(0,nr.jsx)(Xs,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:m=>{let p=m(e);oe(p)&&i(t,p)},reset:()=>{let m={type:"image",value:void 0};i(t,m)}})})}var rr=g(x());function Pl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=B(),l=n.getPropertyControls(s.tree)[t];return A(l?.type==="link"),(0,rr.jsx)(R,{title:l.title??"",warningMessage:r,children:(0,rr.jsx)(Zs,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:m=>{oe(m)&&i(t,m)},reset:()=>{let m={type:"link",value:void 0};i(t,m)}})})}var El="inputWrapper_i4uywus";var ir=g(x());function kl({collectionNode:o,controlProp:n,variableId:e,warningMessage:t,onChange:r}){let i=B(),c=o.getPropertyControls(i.tree)[e];u(c?.type==="multicollectionreference");let l=c.dataIdentifier,m=gi(c,n)??[];return u(!O(m),"Variables are not supported"),(0,ir.jsx)(R,{title:c.title??"",warningMessage:t,children:(0,ir.jsx)(Rs,{large:!0,value:m,onChange:p=>{r(e,{type:"multicollectionreference",value:p})},wrapperClassName:El,dataIdentifier:l})})}var ar=g(x());function Nl({collectionItemNode:o,collectionNode:n,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=B(),l=n.getPropertyControls(s.tree)[t];return A(l?.type==="number"),(0,ar.jsx)(R,{title:l.title??"",warningMessage:r,children:(0,ar.jsx)(js,{control:l,controlProp:e,fieldId:t,itemId:o.id,onChange:m=>{oe(m)&&i(t,m)}})})}var Ko=g(x()),Ol=["left","right","auto-vertical"];function Bl({collectionNode:o,collectionItemNode:n,controlProp:e,variableId:t,onChange:r,warningMessage:i}){let s=B(),l=o.getPropertyControls(s.tree)[t];u(l?.type==="richtext");let m=e&&zr(e.value)?e.value:void 0,p=a=>{r(t,{type:l.type,value:a})},d=Go(()=>et(xo)),f=bt("pasteMarkdown");return(0,Ko.jsx)(R,{title:l.title??"",warningMessage:i,children:f?(0,Ko.jsx)(zo,{enabled:!0,schema:d,compactTagSelector:!0,defaultValue:m??"",onChange:p,scopeType:"ContentManagement",onUnsavedChange:tt,popoverAttachmentEdge:Ol,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0},n.id):(0,Ko.jsx)(Wo,{enabled:!0,supportsEmbeds:!0,supportsMedia:!0,compactTagSelector:!0,defaultValue:m??"",onChange:p,scopeType:"ContentManagement",onUnsavedChange:tt,popoverAttachmentEdge:Ol,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0},n.id)})}var Xo=g(x());function Tl({collectionNode:o,collectionItemNode:n,controlProp:e,variableId:t,onChange:r,warningMessage:i}){let s=B(),l=o.getPropertyControls(s.tree)[t];u(l?.type==="string");let m=e&&ae(e.value)?e.value:void 0,p=l.placeholder,d=l.defaultValue??"",f=m??d,a=w=>{r(t,{type:l.type,value:w})};return(0,Xo.jsx)(R,{title:l.title??"",warningMessage:i,children:l.displayTextArea?(0,Xo.jsx)($i,{value:f,onChange:a,constantChange:!0,placeholder:p,minRows:10,maxRows:30,className:Hs},n.id):(0,Xo.jsx)(ea,{type:l.obscured?"password":"text",value:f,onChange:a,placeholder:p,constantChange:!0,className:Gs})})}var N=g(x());function Rl({fieldIdsToShow:o,requiredFieldsOnly:n,collectionItemId:e,collectionNodeId:t}){let[r,i]=(0,Rt.useState)(()=>new Map),s=r.size>0,c=I(),{treeStore:l,projectStore:m,modalStore:p}=c.stores,d=e!==c.stores.canvasStore.temporaryCollectionItemNodeId,f=l.tree.getNodeWithTrait(t,Ft),a=l.tree.getNodeWithTrait(e,qe);(0,Rt.useEffect)(()=>{(!a||!f||a.parentid!==f.id)&&p.dismiss()},[a,f,p]);let w=n||d,y=()=>{for(let[D,re]of r)l.tree.current(a)?.setControlProp(D,re);w?d?(l.tree.current(a)?.set({privateToUserId:void 0}),m.commitTreeAndSend()):c.stores.canvasStore.saveTemporaryCollectionItem():m.commitTreeAndSend(),p.dismissAll()},C=()=>{Ao()||y()},b=nd({collectionNode:f||void 0,collectionItemNode:a||void 0,tempControlProps:r,fieldIdsToShow:o});function F(D){let ge=f?.getPropertyControls(l.tree)?.[D];if(!ge)return;let W=b.get(D);if(W?.type!=="required")return _o(W,ge)}let v=(D,re)=>{u(a,"CollectionItemNode must be present");let ge=a.getControlProp(D);i(W=>ge?.value===re.value?Jt.remove(W,D):po(ge?.value)&&po(re.value)&&Za(ge.value,re.value)?Jt.remove(W,D):Al(ge)&&Al(re)?Jt.remove(W,D):Jt.set(W,D,re))},U=()=>{if(!s){S();return}p.push({type:"Confirmation",title:"Unsaved Changes",description:"Are you sure that you want to discard your new item?",interactionRequired:!0,onConfirm:()=>S(),cancelLabel:"Continue Editing",confirmLabel:"Discard Item",dismissVariant:"primary",variant:"destructiveSecondary",cancelOnEnter:!0,confirmOnEnter:!1,source:"on_page_hud",buttonDirection:"column",hasBackdrop:!0})},S=()=>{a&&(l.tree.remove(a.id),m.commitTreeAndSend(),p.dismiss())},k=()=>{if(d){U();return}if(n){p.dismiss();return}y()},ue=()=>{if(d){U();return}p.dismiss()};return(0,N.jsxs)(vt,{hasBackdrop:!0,className:dl,visible:o.length>0,onDismiss:k,onConfirm:C,children:[(0,N.jsx)(Pt,{separator:!0,title:d?"New Item":n?"Required Fields":"All Fields",className:ml,children:(0,N.jsx)(Et,{onDismiss:ue})}),(0,N.jsxs)(ca,{className:pl,children:[(0,N.jsx)(ra,{size:0}),o.map(D=>{if(!f||!a)return null;let re=f.getVariable(D);if(!re)return null;let ge=r.get(D)??a.getControlProp(D);return(0,N.jsx)(od,{variable:re,collectionItemNode:a,collectionNode:f,controlProp:ge,onChange:v,getWarningMessage:F},D)})]}),(0,N.jsx)(Eo,{displayDivider:!1,paddingTop:ul,className:gl,gap:te.inputSpacing,children:(0,N.jsxs)(Gi,{children:[n?(0,N.jsx)(G,{bold:!0,onClick:ue,className:Lo,children:(0,N.jsx)(Le,{children:"Cancel"})}):(0,N.jsx)(G,{bold:!0,onClick:ue,className:Lo,children:(0,N.jsx)(Le,{children:s?"Discard":"Cancel"})}),(0,N.jsx)(G,{bold:!0,type:"submit",variant:"primary",className:Lo,enabled:n?b.size===0:s,children:(0,N.jsx)(Le,{children:"Save"})})]})})]})}function od({variable:o,collectionItemNode:n,collectionNode:e,controlProp:t,onChange:r,getWarningMessage:i}){let s=o.type;switch(s){case"slug":return ct(o)?(0,N.jsx)(Ys,{collectionNode:e,collectionItemNode:n,controlProp:t,onChange:r,variable:o,warningMessage:i(o.id)}):null;case"string":return(0,N.jsx)(Tl,{collectionNode:e,collectionItemNode:n,controlProp:t,variableId:o.id,onChange:r,warningMessage:i(o.id)});case"richtext":return(0,N.jsx)(Bl,{collectionNode:e,collectionItemNode:n,controlProp:t,variableId:o.id,onChange:r,warningMessage:i(o.id)});case"link":return(0,N.jsx)(Pl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"image":return(0,N.jsx)(vl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"array":return(0,N.jsx)(Sl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,onChange:r});case"multicollectionreference":return(0,N.jsx)(kl,{collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"collectionreference":return(0,N.jsx)(xl,{collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"file":return(0,N.jsx)(Fl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"date":return(0,N.jsx)(Il,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"number":return(0,N.jsx)(Nl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"boolean":return(0,N.jsx)(fl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"enum":return(0,N.jsx)(bl,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});case"color":return(0,N.jsx)(Ul,{collectionItemNode:n,collectionNode:e,controlProp:t,variableId:o.id,warningMessage:i(o.id),onChange:r});default:Gr(s)}}function nd({collectionNode:o,collectionItemNode:n,tempControlProps:e,fieldIdsToShow:t}){let r=I(),{tree:i}=r.stores.treeStore.useState(),s=as(o,n);return(0,Rt.useMemo)(()=>{let c=new Map;if(!o||!n)return c;for(let l of t){let m=o.getVariable(l);if(!m)continue;let d=o.getPropertyControls(i)[l];if(!d)continue;let f=e.get(l)??n.getControlProp(l),a=s.get(l),w;(ho(m)||ct(m))&&(w=Do(m,o.variables,n));let y=Mo(m.type,d,f,w,void 0,Co(m),a);y&&c.set(l,y)}return c},[o,n,t,s,i,e])}function Al(o){return!o||jr(o.value)?!0:ae(o.value)?Ua(o.value):po(o.value)?o.value.length===0:!1}var jo=g(L());var Dl="editorContainer_e1zu74n";var _l=g(x());function Ml({initialHtml:o,onContentChange:n,onEscape:e}){let t=(0,jo.useRef)(null);return(0,jo.useEffect)(()=>{let r;async function i(){let{baseKeymap:s,chainCommands:c,dropCursor:l,gapCursor:m,history:p,keymap:d,redo:f,undo:a,undoInputRule:w}=await Ot(),y=$e.isOn("pasteMarkdown")?(U,S,k)=>bo(U,S,k):(U,S,k)=>Fo(U,k),C=et(wo),b=y(o,C,{plugins:[p(),d({"Mod-z":c(w,a),"Mod-Shift-z":f,"Shift-Enter":ko(C),"Mod-b":Ln(C.marks.bold),"Mod-i":Ln(C.marks.italic),"Shift-Tab":ba(C.nodes.listItem),Tab:c(Fa(C.nodes.listItem),()=>!0),Backspace:c(w,No(C)),Escape:()=>(e?.(),!!e)}),d(s),l({color:"var(--framer-color-text)",width:2}),m(),Oo()]}),F,v=new yi(null,{state:b,editable:()=>!0,dispatchTransaction:U=>{let S=v.state.apply(U);if(v.updateState(S),F!==S.doc){let k=$e.isOn("pasteMarkdown")?Uo(S.doc,C):Io(S.doc);n(k),F=S.doc}}});t.current&&(t.current.innerHTML="",t.current.appendChild(v.dom)),r=v}return i(),()=>r?.destroy()},[o,n,e]),(0,_l.jsx)("div",{ref:t,className:Dl})}function Ke(o,n){let e=o.webPageNodeId,t=n.tree.getNodeWithTrait(e,ii);if(t?.loaded)return t.loaded;t?.load().catch(ee)}function xe(o,n,e){let r=Ke(o,n)?.getBreakpointValues(),i=pi(r,e.screenWidth);return n.tree.get(i)}function Ae(o,n,e){let t=e.temporaryCollectionItemNodeId??o.collectionItemNodeId;return n.tree.getNodeWithTrait(t,qe)??void 0}function Dt(o,n,e){let t=Ae(o,n,e);if(t)return n.tree.getNodeWithTrait(t.parentid,Ft)??void 0}var Z=class{constructor(n){this.engine=n}};var id=/^(?<hashes>#{1,6})\s$/u,Ce=class o extends Z{constructor(e,t,r,i="none"){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;h(this,"handleOnFocus",()=>this.proseMirrorEditor?.controls.handleOnFocus());h(this,"handleOnBlur",()=>this.proseMirrorEditor?.controls.handleOnBlur());h(this,"proseMirrorEditor",null);h(this,"hasTextFitViewBox",!1);this.engine.beginUndoGroup(),this.start()}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,P)}update(){let e=this.getRichTextNode();if(!e||!o.supportsNode(e)){this.engine.exitTool();return}if(!e.textFitViewBoxSize||this.hasTextFitViewBox)return;let t=Ai(this.engine.tree,e);this.engine.stores.projectStore.commitTreeAndSend(),t&&(this.hasTextFitViewBox=!0)}async stop(){let e=this.getRichTextNode();e&&(e.cache.isEditable=!1),this.proseMirrorEditor?.destroy(),this.proseMirrorEditor=null,this.engine.endUndoGroup(),this.engine.stores.toolStore.proseMirrorView=null,this.engine.stores.toolStore.nodeInTextEditor=null}start(){let e=this.getRichTextNode();if(!e)return;this.hasTextFitViewBox=Oi(this.engine.tree,e),this.engine.stores.projectStore.commitTreeAndSend();let t=Bo(this.engine.tree,e);if(t.length===0){this.init();return}Je.loadFonts(t).catch(ee).finally(()=>this.init())}init(){this.startAsync().catch(e=>{ee(e),this.engine.exitTool()})}async startAsync(){let e=this.getRichTextNode();if(!e)return this.engine.exitTool();this.proseMirrorEditor=await this.createProseMirrorEditor(e),e.cache.isEditable=!0,this.engine.stores.toolStore.proseMirrorView=this.proseMirrorEditor.view}async createProseMirrorEditor(e){let{baseKeymap:t,chainCommands:r,createParagraphNear:i,Decoration:s,DecorationSet:c,dropCursor:l,EditorView:m,ellipsis:p,emDash:d,gapCursor:f,history:a,InputRule:w,inputRules:y,keymap:C,liftEmptyBlock:b,liftListItem:F,newlineInCode:v,redo:U,sinkListItem:S,splitBlock:k,splitListItem:ue,toggleMark:D,undo:re,undoInputRule:ge}=await Ot(),W=this.engine,Y=et(wo),jf=r(ue(Y.nodes.listItem),v,i,b,va(Y),Sa(Y),(q,V)=>k(q,V&&(z=>{let Ze=q.selection,xt=this.getRichTextNode();u(xt,"RichTextNode not found");let Ee=Ze.$from.node(1);if(!Dn(Ee)||!(Ze.$to.parentOffset===Ze.$to.parent.content.size))return V(z);let ye={...Ee.attrs},lt=Rn(Ee)&&ye.tag!=="p",jt=z.mapping.map(q.selection.to),Ut=q.selection.$from.marks();if(lt){let ze=xt.getNodeTextStylePreset(W.tree,"p")??Vn(W.tree,"p")??_n.createDefault("p");Gn(W,ze),xt.setNodeTextStylePreset(ze),W.stores.projectStore.commitTreeAndSend(),ye.textStylePreset=ze.id,ye.tag="p",ye.inlineStyles={},ye.blockStyles={}}else{let ze=Ut.find(hi);ye.inlineStyles={...ye.inlineStyles,...ze?.attrs.inlineStyles}}z.setNodeMarkup(jt-1,void 0,ye),z.setStoredMarks(Ut),lt&&z.removeStoredMark(Y.marks.inlineStyles),V(z)})));function Yf(){return W.exitTool(),!0}u(!O(e.htmlContent),"Can't edit rich text node when htmlContent variable is assigned"),u(!O(e.textContent),"Can't edit rich text node when textContent variable is assigned");let Rr=()=>{let q=this.getRichTextNode();u(q,"RichTextNode not found");let V=q.getNodeInlineCodeStylePreset(W.tree)??ki(W.tree)??new Fi;return Ni(W,V),q.setNodeInlineCodeStylePreset(V),V.id},Dr=($e.isOn("pasteMarkdown")?(q,V,z)=>bo(q,V,z):(q,V,z)=>Fo(q,z))(e.html,Y,{plugins:[a(),C({"Mod-z":r(ge,re),"Mod-Shift-z":U,"Shift-Enter":ko(Y),"Mod-b":D(Y.marks.bold),"Mod-i":D(Y.marks.italic),"Shift-Tab":F(Y.nodes.listItem),Tab:r(S(Y.nodes.listItem),()=>!0),Backspace:r(ge,No(Y)),Escape:Yf,Enter:jf,"Mod-Shift-c":D(Y.marks.inlineCode,{get inlineCodeStylePreset(){return Rr()}})}),C(t),l({color:Vi.cmsRichTextDropCursor,width:te.richTextDropCursor}),f(),Oo(),Ba({engine:this.engine,schema:Y,nodeId:this.nodeId,getRichTextNode:()=>this.getRichTextNode()}),y({rules:[d,p,new w(id,(q,V,z,Ze)=>{let xt=q.doc.resolve(z),Ee=xt.node(1),lo=xt.before(1);if(!Dn(Ee))return null;let ye=q.tr,lt="h"+(V.groups?.hashes?.length||1),jt=this.getRichTextNode();u(jt,"RichTextNode not found");let Ut=jt.getNodeTextStylePreset(W.tree,lt)??Vn(W.tree,lt)??_n.createDefault(lt),ze=Ut.id;return Gn(W,Ut),jt.setNodeTextStylePreset(Ut),W.stores.projectStore.commitTreeAndSend(),Rn(Ee)||ye.removeMark(lo,lo+Ee.nodeSize,Y.marks.inlineStyles),ye.delete(z,Ze),ye.setNodeMarkup(lo,Y.nodes.textBlock,{...Ee.attrs,blockStyles:ze?{}:Ee.attrs.blockStyles,inlineStyles:ze?{}:Ee.attrs.inlineStyles,textStylePreset:ze,tag:lt}),ye}),Pa(Y),Ea(Y)]}),...Ia({markType:Y.marks.inlineCode,attrs:{get inlineCodeStylePreset(){return Rr()}}})]}),Mr,Xe=new m(null,{state:Dr,dispatchTransaction:q=>{let V=this.getRichTextNode();u(V,"Node should not be null");let z=Xe.state.apply(q);if(Xe.updateState(z),z=Bi(z,Xe,V),Mr!==z.doc){let Ze=$e.isOn("pasteMarkdown")?Uo(z.doc,Y):Io(z.doc);V.html!==Ze&&(o.updateNodeWithBreakpointAwareness({engine:this.engine,html:Ze,node:V}),Ti(V,Xe)),Mr=z.doc}this.engine.stores.projectStore.commitTreeAndSend()}});return{controls:{handleOnFocus(){Xe.setProps({decorations(){}})},handleOnBlur(){Xe.setProps({decorations(q){let V=q.selection;if(V.from!==V.to)return document.getSelection()?.removeAllRanges(),c.create(q.doc,[s.inline(V.from,V.to,{class:"selection",nodeName:"mark"})])}})}},destroy:()=>Xe.destroy(),state:Dr,view:Xe}}static updateNodeWithBreakpointAwareness({engine:e,node:t,html:r,breakpointNode:i}){let{tree:s,stores:c}=e,{routeStore:l,canvasStore:m,treeStore:p}=c;i??=xe(l,p,m);let d=t.originalid??t.id,f=!Qr(i)||di(i)||!d,a=!So(s,t,"html"),w=s.getNodeWithTrait(d,P);if(u(w,`originalNode with id ${d} must exist`),f||a){w.set({html:r});return}if(t.getTextContent()===w.getTextContent()){w.set({html:Si(w.html,vi(r))});return}t.set({html:r},s,!1,!1)}static supportsNode(e){return P(e)&&!e.htmlContent&&!e.textContent}};function ce(){let o=I(),{routeStore:n,treeStore:e}=o.stores;return Te(()=>Ke(n,e),[],[n,e])}function Vl(){let o=I(),{routeStore:n,treeStore:e,canvasStore:t}=o.stores;return Te(()=>Ae(n,e,t),[],[n,e,t])}function Gl(){let o=I(),{routeStore:n,treeStore:e,canvasStore:t}=o.stores;return Te(()=>Dt(n,e,t),[],[n,e,t])}var we=g(L());var zl="modal_m168h77v";var fe=g(x());function Wl({richTextNodeId:o}){let n=I(),e=ce(),[t,r]=(0,we.useState)(()=>{let a=xe(n.stores.routeStore,n.stores.treeStore,n.stores.canvasStore);return u(a,"activeOnPageBreakpointNode must exist"),a.id}),i=(0,we.useRef)(new Map),s=(0,we.useMemo)(()=>n.stores.treeStore.tree.getNodeWithTrait(o,P)?.originalid??o,[o]),c=(0,we.useCallback)(()=>n.stores.scopeStore.active.getTopLevelReplicaVariants().find(({id:a})=>t===a),[t]),l=(0,we.useCallback)(()=>{let a=c();if(!a)return;let w=Qt(a.id,s),y=n.stores.treeStore.tree.get(w);return P(y)?y:void 0},[c,s]),m=(0,we.useMemo)(()=>{let a=i.current.get(t);if(a!==void 0)return a;if(t===n.stores.scopeStore.active.getPrimaryVariant().id){let w=n.stores.treeStore.tree.getNodeWithTrait(s,P);return u(w,"originalNode should exist"),w.html}return l()?.html??""},[l,t,s]),p=(0,we.useCallback)(a=>i.current.set(t,a),[t]),d=(0,we.useCallback)(()=>{n.exitTool(),n.stores.modalStore.dismiss()},[]),f=(0,we.useCallback)(()=>{let a=n.stores.scopeStore.active.getPrimaryVariant(),w=i.current.get(a.id);if(w!==void 0){let y=n.stores.treeStore.tree.getNodeWithTrait(s,P);u(y,`originalNode with id ${s} must exist`),y.html!==w&&y.set({html:w})}n.stores.scopeStore.active.getTopLevelReplicaVariants().forEach(y=>{let C=i.current.get(y.id);if(C===void 0)return;let b=Qt(y.id,s),F=n.stores.treeStore.tree.get(b);P(F)&&F.html!==C&&Ce.updateNodeWithBreakpointAwareness({breakpointNode:y,engine:n,html:C,node:F})}),i.current.clear(),n.stores.projectStore.commitTreeAndSend(),d()},[d,s]);return(0,fe.jsxs)(vt,{visible:!0,hasBackdrop:!0,onDismiss:d,className:zl,children:[(0,fe.jsx)(Pt,{separator:!0,title:"Responsive Text",children:(0,fe.jsx)(Et,{onDismiss:d})}),(0,fe.jsxs)(he,{gap:te.inputSpacing,paddingTop:te.modalPadding,children:[(0,fe.jsx)(la,{children:e?.getTopLevelVariants().map(a=>(0,fe.jsx)(sa,{identifier:a.id,title:a.name??a.id,selected:t===a.id,onSelect:r},a.id))}),(0,fe.jsx)(Ml,{initialHtml:m,onContentChange:p,onEscape:d})]}),(0,fe.jsxs)(Eo,{displayDivider:!0,children:[(0,fe.jsx)(G,{bold:!0,onClick:d,variant:"default",children:(0,fe.jsx)(Le,{children:"Cancel"})}),(0,fe.jsx)(G,{bold:!0,onClick:f,variant:"primary",children:(0,fe.jsx)(Le,{children:"Save"})})]})]})}var Yo=g(L());var ql="modal_m1cvfiap",Ll="form_f1nz04q2",Kl="scroll_syo0l7n",Xl="width100_w9541mz",sr="editor_e73gufq";var rt=g(x()),Zl=["left","right","auto-vertical"];function Yl({controlKey:o,nodeId:n}){let e=B(),t=()=>{e.stores.modalStore.dismiss()},r=Te(()=>{let a=e.stores.treeStore.tree.get(n);return!qe(a)&&!be(a)?null:a},[n],["Tree"]),i=Te(()=>{let f=e.tree.getScopeNodeFor(r);return f?Ca(f):null},[r],["Tree"]),s=Te(()=>{if(qe(r)){let f=r?.parentid,a=e.stores.treeStore.tree,w=a.getNodeWithTrait(f,Ft);if(!w)return null;let C=w.getPropertyControls(a)[o];return C?.type==="richtext"?C:null}if(be(r)){let f=Q.reactComponentForIdentifier(r.codeComponentIdentifier);if(!f)return null;let a=f.properties[o];return a?.type==="richtext"?a:null}return null},[o,r],["Tree","ActiveBundle"]),c=(0,Yo.useMemo)(()=>{if(!r)return"";let f=jl(r,o);return ae(f?.value)?f.value:""},[r,o]),l=!!i&&!!r&&s?.type==="richtext",m=f=>{if(!r)return;let a=e.stores.treeStore.tree.current(r);if(!a)return;let w,y=jl(r,o);y?w={...y,value:f}:w={type:"richtext",value:f},qe(a),a.setControlProp(o,w),u(pa(e),"Only on-page engine can commit tree"),e.stores.projectStore.commitTreeAndSend()};(0,Yo.useEffect)(()=>{l||e.stores.modalStore.dismiss()},[l]);let p=Go(()=>et(yo(r)?xo:Ci)),d=bt("pasteMarkdown");return l?(0,rt.jsxs)(vt,{visible:!0,hasBackdrop:!0,onDismiss:t,className:ql,formClassName:Ll,children:[(0,rt.jsx)(Pt,{separator:!0,title:s.title??"Unknown",className:Xl,children:(0,rt.jsx)(Et,{onDismiss:t})}),(0,rt.jsx)(ta,{className:Kl,children:d?(0,rt.jsx)(zo,{enabled:!0,schema:p,className:sr,defaultValue:c,onChange:m,scopeType:i,onUnsavedChange:tt,popoverAttachmentEdge:Zl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0}):(0,rt.jsx)(Wo,{enabled:!0,supportsEmbeds:yo(r),supportsMedia:yo(r),className:sr,defaultValue:c,onChange:m,scopeType:i,onUnsavedChange:tt,popoverAttachmentEdge:Zl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0})})]}):null}function jl(o,n){if(qe(o)){let e=o.getControlProp(n);return e?.type==="richtext"&&ae(e.value)?e:null}if(be(o)){let e=Q.reactComponentForIdentifier(o.codeComponentIdentifier);if(!e)return null;let r=o.getControlProps(e.properties)[n];if(r?.type==="richtext"&&ae(r.value))return r}return null}var to=g(x()),ld={AcquireAddonModal:null,AcquireAdvancedAnalyticsTrialModal:null,AddToLibrary:null,BatchTranslate:null,CodeFileCreation:null,CompleteSignup:null,ComponentIsolationModal:null,Confirmation:Ns,ConfirmBatchTranslateAll:null,ConfirmDefaultLanguage:null,ConfirmDeleteCollectionItems:null,ConfirmDestructiveFeedbackAction:null,ConfirmDraftCollectionItem:null,ConfirmDraftLocale:null,ConfirmDraftPage:null,ConfirmPublishAbTest:null,ConfirmPublishDraftCollectionItem:null,ConfirmPublishDraftLocale:null,ConfirmPublishDraftPage:null,ConfirmRemoveTriggerEvent:null,ConfirmUpdatingAbVariants:null,ConvertToCMSPage:null,CreateAbTest:null,CreateComponent:null,CreateLayoutTemplate:null,CreateManagedCollection:null,CreateTeam:null,DashboardAddRedirect:null,DashboardEditRedirect:null,CustomBreakpoint:null,DeleteCodeFile:null,DeleteCustomFont:null,DeleteEntityFolder:null,DeleteFile:null,DeleteMultipleCodeFiles:null,DeleteMultipleEntityFolders:null,DeprecatedDrafts:null,DuplicateProjectWithVersion:null,DuplicateWebPage:null,FigmaImportTutorial:null,FlexToYearly:null,ImageCrop:Os,ImageFocalPoint:Bs,ImportFigma:null,ImportRedirects:null,LoadingFullDocument:null,LocaleReady:null,LocaleSettings:null,LocalizationGlossary:null,None:null,NudgePreferences:null,OnPageCMSFieldsModal:Rl,OnPageRichTextEditor:Yl,OnPageRichTextVariantOverride:Wl,OverrideFile:null,PasteFromFigma:null,PlanCancellation:null,PluginCustomHTML:null,PluginFromURL:null,PluginWithModePicker:null,PublishModule:null,QuickActions:null,RemoveTeamLibraryModule:null,ReplaceTextStylePreset:null,ReplaceWebPage:null,SelectProjectToUpgrade:null,Shortcuts:null,StopAbTest:null,SubscriptionNotInOrder:null,TransferProject:null,UnlinkComponent:null,UnsavedChanges:null,UnsupportedFileSize:null,UnsupportedFileType:null,UpgradeDocument:null,UpsellEnterprise:null,UpsellFeature:null,Variables:null,VectorImport:null,VectorSetCreation:null,Welcome:null};function Hl(){let n=I().stores.modalStore.useState(e=>e.stack);return n.map((e,t)=>{if(e.type==="None")return null;let r=ld[e.type];u(r,`Modal is missing: ${e.type}`);let{type:i,...s}=e,c=t===n.length-1,l=e.type+t;return(0,to.jsx)(Hi,{allowFocusTrap:c,children:(0,to.jsx)(na.Provider,{value:es(i),children:(0,to.jsx)(oa.Provider,{value:c?"visible":"hidden",children:(0,to.jsx)(r,{...s})})})},l)})}function Ql({accessStore:o,routeStore:n},e){let t=o.access;u(t.status==="success","Can't open Framer if project access is not successful");let r=e??n.projectLinkNodeId,i=`${mo().app}/projects/${t.data.projectSlug}?node=${r}`;window.open(`https://www.framer.com/open-in-app?url=${encodeURIComponent(i)}`,"_blank")}var rc=g(L());var $l="toolbar_t49i6vy",dt="button_bjwo6qr",Mt="buttonSecondary_b1qwl3y9",ec="mainContentContainer_m1wta5up",tc="mainContent_m69kutt",lr="secondaryText_sdjdrec",oc="logoIcon_l9efojb";var cr={slug:!0,string:!0,richtext:!0,link:!0,image:!0,array:!0,multicollectionreference:!0,collectionreference:!0,file:!0,date:!0,number:!0,boolean:!0,enum:!0,color:!0};function Ho(o){return cs(o).flatMap(t=>{let r=t.type;return cr[r]!==void 0?t.id:[]})}var E=g(x());function ic(){let o=I(),{routeStore:n,treeStore:e,canvasStore:t,projectStore:r,modalStore:i}=o.stores,{finishedEditing:s}=t.useState(),{hasPermanentlyFailed:c}=r.useState(),l=s?.isNewItem?"Page saved":"Site saved",m=Vl(),p=Gl(),d=(0,rc.useCallback)(()=>{u(p,"Collection node must exist"),u(m,"Collection item node must exist");let w=Ho(p);o.exitTool(),i.set({type:"OnPageCMSFieldsModal",fieldIdsToShow:w,requiredFieldsOnly:!1,source:"on_page_hud",collectionItemId:m.id,collectionNodeId:p.id})},[n,e,i,o,m,p]),f=()=>{i.set({type:"Confirmation",title:"Discard Changes",description:"All changes will be lost. This action cannot be undone.",confirmLabel:"Discard",cancelLabel:"Cancel",variant:"destructive",source:"on_page_hud",onConfirm:()=>{t.discardTemporaryCollectionItem()}})},a=!!m?.privateToUserId;return(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)("div",{className:$l,children:[a?(0,E.jsxs)(G,{className:X(dt,Mt),onClick:f,children:[(0,E.jsx)(Li,{}),"Discard Page"]}):(0,E.jsx)(fd,{finishedEditing:s}),(0,E.jsxs)("div",{className:ec,children:[(0,E.jsx)(nc,{desktopText:"Click to edit",mobileText:"Tap to edit",secondaryText:"Changes are auto-saved",isVisible:!s}),(0,E.jsx)(nc,{desktopText:l,mobileText:l,secondaryText:`A notification was sent to your collaborators. ${s?.isNewItem?"The page":"Changes"} will be visible when the project is published.`,isVisible:!!s})]}),(0,E.jsxs)(he,{direction:"row",gap:10,children:[p&&!a&&!p.managedByPlugin&&!s&&(0,E.jsxs)(G,{className:X(dt,Mt),enabled:!c,onClick:()=>t.createTemporaryCollectionItem(),"aria-label":"Add Page",children:[(0,E.jsx)(Zi,{}),(0,E.jsx)(Jo,{desktopText:"Add Page",mobileText:"Page"})]}),a&&!c&&(0,E.jsxs)(G,{className:X(dt,Mt),onClick:d,children:[(0,E.jsx)(md,{}),"Show All Fields"]}),s?(0,E.jsxs)(G,{className:X(dt,Mt),onClick:()=>t.handleDismissFinishEditing(),children:[(0,E.jsx)(dd,{}),"Go Back to Site"]}):(0,E.jsxs)(G,{variant:"primary",className:dt,onClick:()=>t.handleFinishEditing(),children:[(0,E.jsx)(qi,{"aria-hidden":"true"}),(0,E.jsx)(Jo,{desktopText:"Finish Editing",mobileText:"Done"})]})]})]})})}function nc({desktopText:o,mobileText:n,secondaryText:e,isVisible:t}){return(0,E.jsx)(Kr,{children:t&&(0,E.jsxs)(Ne.div,{className:tc,initial:{marginTop:10,opacity:0},animate:{marginTop:0,opacity:1},exit:{marginTop:-10,opacity:0},children:[(0,E.jsx)(Jo,{desktopText:o,mobileText:n}),(0,E.jsx)("span",{className:lr,children:"\xB7"}),(0,E.jsx)("span",{className:lr,children:e})]})})}function Jo({desktopText:o,mobileText:n}){let e=ms(`(max-width: ${_i.tabletSmall}px)`);return!n&&e?null:(0,E.jsx)("span",{children:e?n:o})}function fd({finishedEditing:o}){let n=I(),e=()=>{Ql(n.stores,o?.isNewItem?o.nodeId:void 0)};return(0,E.jsxs)(G,{className:X(dt,Mt),onClick:e,"aria-label":"Open in Framer",children:[(0,E.jsx)(Ki,{"aria-hidden":"true",className:oc}),(0,E.jsx)(Jo,{desktopText:"Open in Framer"})]})}function dd(){return(0,E.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"9",height:"9",fill:"none",children:[(0,E.jsx)("path",{d:"M 1.5 7.5 L 8 1",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,E.jsx)("path",{d:"M 3 1 L 8 1 L 8 6",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]})}function md(){return(0,E.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"11",height:"11",fill:"none",children:[(0,E.jsx)("path",{d:"M1 5.5s1.5-3 4.5-3 4.5 3 4.5 3-1.5 3-4.5 3-4.5-3-4.5-3Z",fill:"transparent",strokeWidth:"1.5",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round"}),(0,E.jsx)("path",{d:"M5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z",fill:"#fff"})]})}var Re=class extends Z{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i}getNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,St)||this.engine.tree.getNodeWithTrait(this.nodeId,P)}getVariableInfo(){let e=this.getNode();if(!e)return;let t=Mn(e);if(!t)return;let r=e.cache.getRenderInstance(this.renderId);if(r)return T(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,t,"collectionreference",r.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,controlProp:i}=t;i.value!==e&&r.setControlProp(t.variableDefinition.id,{...i,value:e})}static supportsNode(e,t,r){let i=Mn(t);if(!i)return!1;let s=t.cache.getRenderInstance(r);return s?!!T(e.tree,e.stores.treeStore.sandboxCollectionData,i,"collectionreference",s.collectionItemId):!1}};var De=class o extends Z{constructor(e,t,r){super(e);this.nodeId=t;this.renderId=r}getCodeComponentNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,be)}getEditableControls(){let e=this.getCodeComponentNode();if(e)return o.getEditableControls(this.engine,e,this.renderId)}update(){let e=this.engine,t=this.getCodeComponentNode();(!t||!o.supportsNode(e,t,this.renderId))&&e.exitTool()}stop(){let{modalStore:e}=this.engine.stores;e.stack.some(({type:r})=>r==="OnPageRichTextEditor")&&e.dismissAll()}static getEditableControls(e,t,r){let i=t.cache.getRenderInstance(r);if(!i)return co();let s=Q.reactComponentForIdentifier(t.codeComponentIdentifier);if(!s)return co();let c=t.getControlProps(s.properties);if(!c)return co();let l=[],m=Ms(e,t.codeComponentIdentifier);if(ai(t)&&m)if(si(t)){let p=T(e.tree,e.stores.treeStore.sandboxCollectionData,t.dynamicVectorSetIdentifier,"vectorsetitem",i.collectionItemId);p&&l.push({type:"collection",controlKey:"dynamicVectorSetIdentifier",variableInfo:p})}else _r(t.codeComponentIdentifier)&&l.push({type:"vectorSetItem",codeComponentIdentifier:t.codeComponentIdentifier});for(let p in c){let d=c[p];if(!d)continue;let f=s.properties[p];if(f){if(d.type==="string"){if(O(d.value)){let a=T(e.tree,e.stores.treeStore.sandboxCollectionData,d.value,d.type,i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!Oe(d.value)){u(f.type==="string");let a=Nt(f);u(a,"Reduced control prop should not be null"),kt(a,d,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:d,reducedControlProp:a})}}if(d.type==="richtext"){if(O(d.value)){let a=T(e.tree,e.stores.treeStore.sandboxCollectionData,d.value,d.type,i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!Oe(d.value)){u(f.type==="richtext");let a=Nt(f);u(a,"Reduced control prop should not be null"),kt(a,d,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:d,reducedControlProp:a})}}if(d.type==="image"){if(O(d.value)){let a=T(e.tree,e.stores.treeStore.sandboxCollectionData,d.value,d.type,i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!Oe(d.value)){u(f.type==="image"||f.type==="responsiveimage");let a=Nt(f);u(a,"Reduced control prop should not be null"),kt(a,d,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:d,reducedControlProp:a})}}if(d.type==="date"){if(O(d.value)){let a=T(e.tree,e.stores.treeStore.sandboxCollectionData,d.value,"date",i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!Oe(d.value)){u(f.type==="date");let a=Nt(f);u(a,"Reduced control prop should not be null"),kt(a,d,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:d,reducedControlProp:a})}}if(d.type==="vectorsetitem"){if(O(d.value)){let a=T(e.tree,e.stores.treeStore.sandboxCollectionData,d.value,"vectorsetitem",i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}else if(!Oe(d.value)){u(f.type==="vectorsetitem");let a=Nt(f);u(a,"Reduced control prop should not be null"),kt(a,d,f),l.push({type:"component",controlKey:p,controlDescription:f,controlProp:d,reducedControlProp:a})}}if(d.type==="link"&&O(d.value)){let a=T(e.tree,e.stores.treeStore.sandboxCollectionData,d.value,"link",i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}if(d.type==="boolean"&&O(d.value)){let a=T(e.tree,e.stores.treeStore.sandboxCollectionData,d.value,"boolean",i.collectionItemId);if(!a)continue;l.push({type:"collection",controlKey:p,variableInfo:a})}}}return l}static supportsNode(e,t,r){return be(t)?o.getEditableControls(e,t,r).length>0:!1}};var Me=class o extends Z{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,P)}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=o.getVariableReference(e);if(r)return T(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"date",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();(!t||!o.supportsNode(e,t,this.renderId))&&e.exitTool()}static getVariableReference(e){let t=e.textContent;if(!uo(t))return;let r=t.startValue;if(O(r))return r}static supportsNode(e,t,r){if(!P(t))return!1;let i=o.getVariableReference(t);if(!i)return!1;let s=t.cache.getRenderInstance(r);return s?!!T(e.tree,e.stores.treeStore.sandboxCollectionData,i,"date",s.collectionItemId):!1}};var _e=class o extends Z{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,P)}static getVariableReference(e){let t=e.textContent;if(!uo(t))return;let r=t.startValue;if(O(r))return r}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=o.getVariableReference(e);if(r)return T(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"enum",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}static supportsNode(e,t,r){if(!P(t))return!1;let i=o.getVariableReference(t);if(!i)return!1;let s=t.cache.getRenderInstance(r);return s?!!T(e.tree,e.stores.treeStore.sandboxCollectionData,i,"enum",s.collectionItemId):!1}};var Ve=class o extends Z{constructor(e,t,r){super(e);this.nodeId=t;this.renderId=r}update(){let e=this.engine,t=e.tree.get(this.nodeId);(!t||!o.supportsNode(e,t,this.renderId))&&e.exitTool()}static supportsNode(e,t,r){if(!St(t))return!1;if(O(t.fillImage)){let i=t.cache.getRenderInstance(r);return i?!!T(e.tree,e.stores.treeStore.sandboxCollectionData,t.fillImage,"image",i.collectionItemId):!1}return!oi(t.fillImage)}};var Fe=class o extends Z{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;h(this,"controls");this.engine.beginUndoGroup(),Ot().then(s=>{e.stores.toolStore.proseMirror??=s})}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,P)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.htmlContent;if(O(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=this.getVariableReference();if(r)return T(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"richtext",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!o.supportsNode(e,t,this.renderId))e.exitTool();else{let r=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(r)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditor=void 0}static supportsNode(e,t,r){if(!P(t)||!O(t.htmlContent))return!1;let i=t.cache.getRenderInstance(r);return i?!!T(e.tree,e.stores.treeStore.sandboxCollectionData,t.htmlContent,"richtext",i.collectionItemId):!1}};var Se=class o extends Z{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;this.engine.beginUndoGroup();let s=this.getRichTextNode();u(s,"Missing rich text node");let c=Bo(this.engine.tree,s);Je.loadFonts(c).catch(ee)}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,P)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.textContent;if(O(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=this.getVariableReference();if(r)return T(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"string",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!o.supportsNode(e,t,this.renderId))e.exitTool();else{let r=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(r)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditor=null}static supportsNode(e,t,r){if(!P(t)||!O(t.textContent))return!1;let i=t.cache.getRenderInstance(r);return i?!!T(e.tree,e.stores.treeStore.sandboxCollectionData,t.textContent,"string",i.collectionItemId):!1}};var ve=class o extends Z{update(){let n=this.engine,{routeStore:e,canvasStore:t,treeStore:r,mouseStore:i,toolStore:s}=n.stores,c=xe(e,r,t);if(!c||i.isHoveringFloatingCanvasChrome)return;if(i.isHoveringChrome){s.highlightedRenderId=void 0;return}let l=r.tree,m=i.canvasMousePosition,p=l.getNodeRendersAtPoint(c,m,!0),d=Di(p,l),a=d.filter(C=>o.isSelectableNodeOrTopLevelRepeaterNode(n,C.node,C.renderId)).at(-1);if(a){n.stores.toolStore.highlightedRenderId=a.renderId;return}let y=d.filter(C=>o.isUnexpectedlyUnselectableNode(n,C.node,C.renderId)).at(-1);if(y){s.highlightedRenderId=y.renderId;return}s.highlightedRenderId=void 0}static isSelectableNodeOrTopLevelRepeaterNode(n,e,t){return o.isSelectableNode(n,e,t)||Qo(n,e)}static isSelectableNode(n,e,t){return De.supportsNode(n,e,t)||Me.supportsNode(n,e,t)||Ve.supportsNode(n,e,t)||Ce.supportsNode(e)||Fe.supportsNode(n,e,t)||Se.supportsNode(n,e,t)||Re.supportsNode(n,e,t)||_e.supportsNode(n,e,t)}static isUnexpectedlyUnselectableNode(n,e,t){return o.isSelectableNode(n,e,t)?!1:wi(e)||be(e)}};function Qo(o,n){return!(!ri(n)||ns(o.tree,n)||go(o.tree.getWebPageNodeFor(n)))}var ac;(function(o){o[o.None=0]="None",o[o.Mutable=1]="Mutable",o[o.Watching=2]="Watching",o[o.RecursedCheck=4]="RecursedCheck",o[o.Recursed=8]="Recursed",o[o.Dirty=16]="Dirty",o[o.Pending=32]="Pending"})(ac||(ac={}));function sc({update:o,notify:n,unwatched:e}){let t=0;return{link:r,unlink:i,propagate:s,checkDirty:m,endTracking:l,startTracking:c,shallowPropagate:p};function r(f,a){let w=a.depsTail;if(w!==void 0&&w.dep===f)return;let y;if(a.flags&4&&(y=w!==void 0?w.nextDep:a.deps,y!==void 0&&y.dep===f)){y.version=t,a.depsTail=y;return}let C=f.subsTail;if(C!==void 0&&C.version===t&&C.sub===a)return;let b=a.depsTail=f.subsTail={version:t,dep:f,sub:a,prevDep:w,nextDep:y,prevSub:C,nextSub:void 0};y!==void 0&&(y.prevDep=b),w!==void 0?w.nextDep=b:a.deps=b,C!==void 0?C.nextSub=b:f.subs=b}function i(f,a=f.sub){let w=f.dep,y=f.prevDep,C=f.nextDep,b=f.nextSub,F=f.prevSub;return C!==void 0?C.prevDep=y:a.depsTail=y,y!==void 0?y.nextDep=C:a.deps=C,b!==void 0?b.prevSub=F:w.subsTail=F,F!==void 0?F.nextSub=b:(w.subs=b)===void 0&&e(w),C}function s(f){let a=f.nextSub,w;e:do{let y=f.sub,C=y.flags;if(C&3&&(C&60?C&12?C&4?!(C&48)&&d(f,y)?(y.flags=C|40,C&=1):C=0:y.flags=C&-9|32:C=0:y.flags=C|32,C&2&&n(y),C&1)){let b=y.subs;if(b!==void 0){f=b,b.nextSub!==void 0&&(w={value:a,prev:w},a=f.nextSub);continue}}if((f=a)!==void 0){a=f.nextSub;continue}for(;w!==void 0;)if(f=w.value,w=w.prev,f!==void 0){a=f.nextSub;continue e}break}while(!0)}function c(f){++t,f.depsTail=void 0,f.flags=f.flags&-57|4}function l(f){let a=f.depsTail,w=a!==void 0?a.nextDep:f.deps;for(;w!==void 0;)w=i(w,f);f.flags&=-5}function m(f,a){let w,y=0;e:do{let C=f.dep,b=C.flags,F=!1;if(a.flags&16)F=!0;else if((b&17)===17){if(o(C)){let v=C.subs;v.nextSub!==void 0&&p(v),F=!0}}else if((b&33)===33){(f.nextSub!==void 0||f.prevSub!==void 0)&&(w={value:f,prev:w}),f=C.deps,a=C,++y;continue}if(!F&&f.nextDep!==void 0){f=f.nextDep;continue}for(;y;){--y;let v=a.subs,U=v.nextSub!==void 0;if(U?(f=w.value,w=w.prev):f=v,F){if(o(a)){U&&p(v),a=f.sub;continue}}else a.flags&=-33;if(a=f.sub,f.nextDep!==void 0){f=f.nextDep;continue e}F=!1}return F}while(!0)}function p(f){do{let a=f.sub,w=f.nextSub,y=a.flags;(y&48)===32&&(a.flags=y|16,y&2&&n(a)),f=w}while(f!==void 0)}function d(f,a){let w=a.depsTail;if(w!==void 0){let y=a.deps;do{if(y===f)return!0;if(y===w)break;y=y.nextDep}while(y!==void 0)}return!1}}var fr=[],{link:oo,unlink:dr,propagate:pd,checkDirty:lc,endTracking:cc,startTracking:fc,shallowPropagate:dc}=sc({update(o){return"getter"in o?yc(o):hc(o,o.value)},notify:Cc,unwatched(o){if("getter"in o){let n=o.deps;if(n!==void 0){o.flags=17;do n=dr(n,o);while(n!==void 0)}}else"previousValue"in o||Uc.call(o)}}),pr=0,$o=0,mr=0,it,en;function _t(o){let n=it;return it=o,n}function mc(){++pr}function pc(){--pr||xc()}function uc(o){return gd.bind({previousValue:o,value:o,subs:void 0,subsTail:void 0,flags:1})}function ur(o){return ud.bind({value:void 0,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:17,getter:o})}function gc(o){let n={fn:o,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:2};it!==void 0?oo(n,it):en!==void 0&&oo(n,en);let e=_t(n);try{n.fn()}finally{_t(e)}return Uc.bind(n)}function yc(o){let n=_t(o);fc(o);try{let e=o.value;return e!==(o.value=o.getter(e))}finally{_t(n),cc(o)}}function hc(o,n){return o.flags=1,o.previousValue!==(o.previousValue=n)}function Cc(o){let n=o.flags;if(!(n&64)){o.flags=n|64;let e=o.subs;e!==void 0?Cc(e.sub):fr[mr++]=o}}function wc(o,n){if(n&16||n&32&&lc(o.deps,o)){let t=_t(o);fc(o);try{o.fn()}finally{_t(t),cc(o)}return}else n&32&&(o.flags=n&-33);let e=o.deps;for(;e!==void 0;){let t=e.dep,r=t.flags;r&64&&wc(t,t.flags=r&-65),e=e.nextDep}}function xc(){for(;$o<mr;){let o=fr[$o];fr[$o++]=void 0,wc(o,o.flags&=-65)}$o=0,mr=0}function ud(){let o=this.flags;if(o&16||o&32&&lc(this.deps,this)){if(yc(this)){let n=this.subs;n!==void 0&&dc(n)}}else o&32&&(this.flags=o&-33);return it!==void 0?oo(this,it):en!==void 0&&oo(this,en),this.value}function gd(...o){if(o.length){let n=o[0];if(this.value!==(this.value=n)){this.flags=17;let e=this.subs;e!==void 0&&(pd(e),pr||xc())}}else{let n=this.value;if(this.flags&16&&hc(this,n)){let e=this.subs;e!==void 0&&dc(e)}return it!==void 0&&oo(this,it),n}}function Uc(){let o=this.deps;for(;o!==void 0;)o=dr(o,this);let n=this.subs;n!==void 0&&dr(n),this.flags=0}var tn=g(L());function de(o=Object.is){return(n,e)=>{let t=new WeakMap;return{get(){let r=t.get(this);return u(r,"Signal must exist"),r()},set(r){let i=t.get(this);u(i,"Signal must exist");let s=i();if(!o(s,r))return this.scheduler.signalChanges(this),i(r)},init(r){let i=uc(r);t.set(this,i)}}}}function Ic(o=Object.is){return(n,e)=>{let t=new WeakMap;return function(){let r=t.get(this);if(r)return r();let i=ur(s=>{let c=n.call(this);return se(s)?c:o(s,c)?s:c});return t.set(this,i),i()}}}function Vt(o,n,e=Object.is){let t=(0,tn.useMemo)(()=>{let r=ur(i=>{let s=o();return se(i)?s:e(i,s)?i:s});return{subscribe(i){return gc(()=>{r(),i()})},getSnapshot(){return r()}}},[...n,e]);return(0,tn.useSyncExternalStore)(t.subscribe,t.getSnapshot)}function bc(){mc()}function Fc(){pc()}var Ec=g(L());var Sc="container_ci35ri5",vc="shockwaveMask_suurpvn",Pc="shockwaveNodeHighlight_s1xlu29h";var on=g(x()),kc=(0,Ec.memo)(function(){let n=I(),e=Vt(()=>n.stores.editableNodeHighlightStore.editableNodesHighlight,[]);return e?(0,on.jsx)(Ne.div,{className:X(Sc,vc),initial:{"--radius":`${e.minRadius}px`},animate:{"--radius":`${e.maxRadius}px`},transition:{duration:e.animationDuration/1e3,ease:"easeOut"},style:{top:e.minY,height:e.maxY-e.minY,"--x":`${e.originX}px`,"--y":`${e.originY}px`,"--gradient-size":`${e.gradientSize}px`},children:(0,on.jsx)("div",{style:{position:"absolute",top:-e.minY},children:e.highlights.map(t=>(0,on.jsx)("div",{className:Pc,style:{width:t.width,height:t.height,transform:t.transform,transformOrigin:"top left"}},t.renderId))})},e.animationId):null});var Nc="hudContainer_h1czcor4";var Bc=g(L());var nn=g(L()),Oc=g(x()),H=(0,nn.forwardRef)(function({tree:n,node:e,renderId:t,style:r,overrideRect:i,...s},c){let l=(0,nn.useMemo)(()=>{if(i)return i;let p=n.getRect(e,void 0,void 0,void 0,t);return{width:p.width,height:p.height,x:0,y:0}},[n,e,t,i]),m=n.transformMatrixToNode(e,void 0,void 0,t);return(0,Oc.jsx)("div",{...s,ref:c,style:{position:"absolute",width:l.width,height:l.height,top:l.y,left:l.x,transformOrigin:"top left",transform:m.toString(),...r}})});var gr=g(x());function Tc({tool:o}){let{renderId:n}=o,e=ce(),t=I(),r=t.tree,i=(0,Bc.useRef)(null),s=o.getNode();if(Tt(i,()=>{t.exitTool()}),!!s&&e)return(0,gr.jsx)(H,{ref:i,tree:r,node:s,renderId:n,children:(0,gr.jsx)(bs,{tool:o,node:s,renderId:n,scopeNode:e})})}var Ac=g(L());function Gt(o){let n=I(),{domLayoutUpdate:e,tree:t}=n.stores.treeStore.useState();return(0,Ac.useMemo)(()=>{let r=t.getNode(o);if(!r)return;let i=xe(n.stores.routeStore,n.stores.treeStore,n.stores.canvasStore);if(!i)return;let s=e;return Cd(n,i,r)},[e,o,t])}function Cd(o,n,e){let{tree:t}=o.stores.treeStore,r=t.convertFrameToCanvas(e),i=t.getNodesInRect(n,r,!0),s=[],c=n.cache.layoutTemplateRects;if(c)for(let[b,F]of c)!F.canvasRect||!ke.intersects(F.canvasRect,r)||s.push(new bi({zIndex:F.domRect.zIndex,id:b,parentid:n.id}));let l=i.concat(s),m=Ri(l,t,{[n.id]:s}),p=m.findIndex(b=>b.id===e.id);if(p===-1)return;let d=m.slice(p+1);if(d.length===0)return;let a=t.transformMatrixToNode(e).inverse(),{windowMousePositionOnToolEntry:w}=o.stores.toolStore,y=w?{x:w.x+window.scrollX,y:w.y+window.scrollY,width:1,height:1}:void 0,C=`M ${-at},${-at} L ${-at},${r.height+at} L ${r.width+at},${r.height+at} L ${r.width+at},${-at} Z`;for(let b of d){let F=c?.get(b.id),v=t.convertFrameToCanvas(b);if(y&&ke.intersects(y,v))continue;let U;F?.canvasCorners?U=F.canvasCorners:U=t.convertCornerPointsToCanvas(b);let S=U[0];S&&U.push(S);for(let{x:k,y:ue}of U){let D=new DOMPoint(k,ue).matrixTransform(a);C+=` L ${D.x},${D.y}`}C+=" Z"}return`path("${C}")`}var at=100;var Rc="validationBadge_v1r7rm12";var an=g(x());function wd(o){return o.message}function rn({validationWarning:o}){if(!o)return null;let n=wd(o);return(0,an.jsxs)("div",{className:Rc,children:[(0,an.jsx)(ji,{width:10,height:10}),n]})}var no=g(x());function Dc({tool:o}){let{nodeId:n,renderId:e}=o,t=I(),{treeStore:r,toolStore:i}=t.stores,{validationWarning:s}=t.stores.toolStore.useState(),{tree:c}=r.useState(),l=Gt(n),m=ce(),{proseMirror:p}=i.useState(),d=c.getNodeWithTrait(n,P);if(!d||!m||!p)return;function f(a){a.target===a.currentTarget&&t.exitTool()}return(0,no.jsxs)(H,{tree:c,node:d,renderId:e,children:[(0,no.jsx)(rn,{validationWarning:s}),(0,no.jsx)(Ps,{tool:o,scopeNode:m,node:d,renderId:e,proseMirror:p,zoom:1,onClickOutside:f,hasValidationWarning:!!s,style:{clipPath:l}})]})}var zt=g(L());var Mc="popover_p6dts5z",_c="popoverWithModalInFront_pcmqzkm";var sn="nodeHighlight_nbqylm8",Vc="visuallyHidden_v1pcr3uc",Gc="pointerCursor_p1mivvux",zc="textCursor_t42x8tu",Wc="notAllowedCursor_n1atul0u",qc="background_b1i0g06w",Lc="repeaterActionButtonLine_r1t4nog5",Kc="repeaterActionButtonTop_r1wgs7ug",Xc="repeaterActionButtonBottom_rsrrcv7",Zc="repeaterActionButtonLeft_rckttk2",jc="repeaterActionButtonRight_r12nxotj",Yc="repeaterActionButton_r460cpk",Hc="repeaterActionIcon_rrb252f",Jc="clickThrough_cxpkzma";var j=g(x()),Ud=["bottom","top","right","left"],Id={x:te.inputSpacing,y:te.inputSpacing};function $c({tool:o}){let[n,e]=(0,zt.useState)(null),t=I(),r=t.stores.modalStore.useState(a=>a.active.type!=="None"),[i,s]=(0,zt.useState)(!1);!i&&r&&s(!0);let{tree:c}=t.stores.treeStore.useState(),l=c.getNodeWithTrait(o.nodeId,fi),m=(0,zt.useMemo)(()=>{let a=c;return o.getEditableControls()},[o,c]);function p(){t.exitTool()}let d=l?.id,f=(0,zt.useMemo)(()=>d?[d]:[],[d]);if(!(!l||!m||m.length===0))return(0,j.jsx)(H,{tree:c,node:l,ref:e,renderId:o.renderId,className:sn,children:(0,j.jsx)(Po,{anchor:n,alignSelf:"center",attachTo:Ud,offset:Id,onClose:p,showArrow:!0,arrow:{anchor:n,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,className:X(Mc,r&&_c),focusTrapEnabled:!r,animateAppear:!i,zIndex:21,children:(0,j.jsx)(Fs,{displayDivider:!0,title:bd(l),onClose:p,children:(0,j.jsx)(he,{gap:0,paddingTop:te.inputSpacing,paddingBottom:te.inputSpacing,paddingLeft:te.panelPadding,paddingRight:te.panelPadding,children:m.map(a=>{if(a.type==="vectorSetItem")return(0,j.jsx)(Ds,{nodeIds:f,supportsVariables:!1,dynamicVectorSetIdentifier:void 0,codeComponentIdentifier:a.codeComponentIdentifier},"vectorSet");if(a.type==="component")switch(a.controlDescription.type){case"string":return u(a.reducedControlProp.type==="string"),(0,j.jsx)(eo,{nodeIds:f,controlKey:a.controlKey,control:a.controlDescription,controlProp:a.reducedControlProp,onChange:(U,S)=>{u(a.controlProp.type==="string");let k=S(a.controlProp);Ie(k,a.controlProp)||(l.setControlProp(U,k),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"richtext":return u(a.reducedControlProp.type==="richtext"),(0,j.jsx)(zn,{title:a.controlDescription.title??"Unknown",children:(0,j.jsx)(G,{title:"Edit Content",className:Wn,onClick:()=>{t.stores.modalStore.set({type:"OnPageRichTextEditor",controlKey:a.controlKey,nodeId:o.nodeId,source:"on_page_hud"})}})},a.controlKey);case"image":case"responsiveimage":return u(a.reducedControlProp.type==="image"||a.reducedControlProp.type==="responsiveimage"),(0,j.jsx)(Kn,{nodeIds:f,controlKey:a.controlKey,control:a.controlDescription,controlProp:a.reducedControlProp,onChange:(U,S)=>{u(y.type==="image");let k=S(y);Ie(k,y)||(l.setControlProp(U,k),t.stores.projectStore.commitTreeAndSend())},onUpload:async(U,S)=>{let k=await U;if(!k)return;u(a.controlProp.type==="image");let ue=As(a.controlProp,k);l.setControlProp(S,ue),t.stores.projectStore.commitTreeAndSend()}},a.controlKey);case"date":return u(a.reducedControlProp.type==="date"),(0,j.jsx)(qn,{controlKey:a.controlKey,control:a.controlDescription,controlProp:a.reducedControlProp,onChange:(U,S)=>{u(U.type==="date"),!Ie(U,y)&&(l.setControlProp(S,U),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"vectorsetitem":return u(a.reducedControlProp.type==="vectorsetitem"),(0,j.jsx)(Xn,{controlKey:a.controlKey,control:a.controlDescription,controlProp:a.reducedControlProp,onChange:(U,S)=>{u(U.type==="vectorsetitem"),!Ie(U,a.controlProp)&&(l.setControlProp(S,U),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);default:Ht(a.controlDescription)}let{variableInfo:w}=a,{controlProp:y,controlDescription:C,collectionItemNode:b,variableDefinition:F,reducedControlProp:v}=w;switch(y.type){case"string":return u(C.type==="string"),u(v.type==="string"),(0,j.jsx)(eo,{nodeIds:f,controlKey:F.id,control:C,controlProp:v,onChange:(U,S)=>{u(y.type==="string");let k=S(y);Ie(k,y)||(b.setControlProp(U,k),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"richtext":return u(C.type==="richtext"),u(v.type==="richtext"),(0,j.jsx)(zn,{title:C.title||ti(F.id),children:(0,j.jsx)(G,{title:"Edit Content",className:Wn,onClick:()=>{t.stores.modalStore.set({type:"OnPageRichTextEditor",controlKey:F.id,nodeId:b.id,source:"on_page_hud"})}})},a.controlKey);case"image":return u(C.type==="responsiveimage"),u(v.type==="responsiveimage"),(0,j.jsx)(Kn,{nodeIds:f,controlKey:F.id,control:C,controlProp:v,onChange:(U,S)=>{u(y.type==="image");let k=S(y);Ie(k,y)||(b.setControlProp(U,k),t.stores.projectStore.commitTreeAndSend())},onUpload:async(U,S)=>{let k=await U;k&&(b.setControlProp(S,{type:"image",value:k}),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"date":return u(C.type==="date"),u(v.type==="date"),(0,j.jsx)(qn,{controlKey:F.id,control:C,controlProp:v,onChange:(U,S)=>{u(U.type==="date"),u(y.type==="date"),!Ie(U,y)&&(b.setControlProp(S,U),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"link":return u(C.type==="link"),u(v.type==="link"),(0,j.jsx)(tl,{controlKey:F.id,control:C,controlProp:v,onChange:(U,S)=>{u(y.type==="link");let k=S(y);Ie(k,y)||(b.setControlProp(U,k),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"boolean":return u(C.type==="boolean"),u(v.type==="boolean"),(0,j.jsx)(qo,{nodeIds:f,controlKey:F.id,control:C,controlProp:v,onChange:(U,S)=>{u(U.type==="boolean"),u(y.type==="boolean"),!Ie(U,y)&&(b.setControlProp(S,U),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);case"vectorsetitem":return u(C.type==="vectorsetitem"),u(v.type==="vectorsetitem"),(0,j.jsx)(Xn,{controlKey:F.id,control:C,controlProp:v,onChange:(U,S)=>{u(U.type==="vectorsetitem"),u(y.type==="vectorsetitem"),!Ie(U,y)&&(b.setControlProp(S,U),t.stores.projectStore.commitTreeAndSend())}},a.controlKey);default:Ht(y)}})})})})})}function bd(o){let n=Q.reactComponentForIdentifier(o.codeComponentIdentifier);return n?n.name:"Component"}var ln=g(L());var yr=g(x());function ef({tool:o}){let{nodeId:n,renderId:e}=o,t=I(),r=t.tree,i=(0,ln.useRef)(null),s=ce(),c=r.getNodeWithTrait(n,P);if(Tt(i,()=>{t.exitTool()}),(0,ln.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"})),!!c&&s)return(0,yr.jsx)(H,{ref:i,tree:r,node:c,renderId:e,children:(0,yr.jsx)(Ss,{tool:o,scopeNode:s,node:c,renderId:e,backdropEnabled:!0})})}var tf=g(L());var hr=g(x());function of({tool:o}){let{nodeId:n,renderId:e}=o,t=I(),r=t.tree,i=(0,tf.useRef)(null),s=ce(),c=r.getNodeWithTrait(n,P);if(Tt(i,()=>{t.exitTool()}),!!c&&s)return(0,hr.jsx)(H,{ref:i,tree:r,node:c,renderId:e,children:(0,hr.jsx)(vs,{tool:o,node:c,renderId:e,scopeNode:s})})}var mt=g(L());var ne=g(x());function nf(){let o=I(),{tree:n}=o.stores.treeStore.useState(),{highlightedRenderId:e}=o.stores.toolStore.useState(),t=Vt(()=>o.stores.mouseStore.lastUpdateType==="scroll",[]),r=Vt(()=>o.stores.mouseStore.isHoveringFloatingCanvasChrome,[]),i=bt("onPageQuickAddRepeaterItems"),s=$t(e),c=n.get(s),l=Zr(c),m=!se(e),p=Pd(c,e),d=(0,mt.useMemo)(()=>{if(!i||!c||!e)return null;if(Qo(o,c))return c;let y=c.ancestors();for(let C of y)if(Qo(o,C))return C;return null},[c,e,i]),f=l&&m&&ve.isSelectableNode(o,c,e),a=l&&m&&ve.isUnexpectedlyUnselectableNode(o,c,e),w=l&&m&&(Ce.supportsNode(c)||Fe.supportsNode(o,c,e)||Se.supportsNode(o,c,e));return(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(Fd,{notAllowedCursor:a}),l&&m&&(0,ne.jsxs)(ne.Fragment,{children:[f&&!a&&!r&&(0,ne.jsx)(H,{tree:n,node:c,renderId:e,className:X(sn,t&&Vc,w?zc:Gc),onClick:p}),!!d&&!t&&(0,ne.jsx)(vd,{tree:n,highlightedRenderId:e,repeaterNode:d})]})]})}function Fd(o){let n=I(),e=(0,mt.useCallback)(()=>{n.stores.editableNodeHighlightStore.highlight(n,{type:"clickOnVoid"})},[]);return(0,ne.jsx)("div",{"aria-hidden":!0,className:X(qc,o.notAllowedCursor&&Wc),onClick:e})}var Sd=o=>{switch(o){case"top":return Kc;case"bottom":return Xc;case"left":return Zc;case"right":return jc}};function vd(o){let n=I(),{mouseStore:e}=n.stores,{tree:t,highlightedRenderId:r,repeaterNode:i}=o,s=Vt(()=>e.canvasMousePosition,[],$r),c=(0,mt.useMemo)(()=>{if(!i)return;let m=Ui(t,i);if(!m)return;let p=m.cache.domRects,d=null;for(let[f,a]of p??[])d=d?ke.merge(d,a):a;if(d)return d},[t,i]),l=(0,mt.useMemo)(()=>{let m="bottom";if(!i)return m;let p=ni(i)&&i.stackDirection==="horizontal"&&!i.stackWrapEnabled,d=t.convertFrameToCanvas(i,c,r);if(p){let F=d.x,v=F+d.width,U=window.scrollX,S=U+window.innerWidth,k=F>=U&&F<=S,ue=v>=U&&v<=S;if(k&&!ue)return"left";if(ue&&!k)return"right";if(k&&ue){let D=s.x-F,re=v-s.x;return D<re?"left":"right"}return"right"}let f=d.y,a=f+d.height,w=window.scrollY,y=w+window.innerHeight,C=f>=w&&f<=y,b=a>=w&&a<=y;if(C&&!b)return"top";if(b&&!C)return"bottom";if(C&&b){let F=s.y-f,v=a-s.y;return F<v?"top":"bottom"}return m},[i,r,c,s,t.convertFrameToCanvas]);return i?(0,ne.jsx)(H,{tree:t,node:i,renderId:r,className:Jc,overrideRect:c,children:(0,ne.jsxs)("button",{type:"button",className:X(Yc,Sd(l)),onMouseDown:()=>Ed(n,i.id),[jn]:"true",children:[(0,ne.jsx)(Yi,{className:Hc,children:(0,ne.jsx)(Wi,{})}),(0,ne.jsx)("div",{className:Lc})]})}):null}function Pd(o,n){let e=I();return(0,mt.useCallback)(()=>{if(!(!o||!n)){if(De.supportsNode(e,o,n))return e.startComponentInstanceEditTool(o.id,n);if(Me.supportsNode(e,o,n))return e.startDateVariableEditTool(o.id,n,"mouse");if(Ve.supportsNode(e,o,n))return e.startImageEditTool(o.id,n);if(Ce.supportsNode(o))return e.startRichTextEditTool(o.id,n,"mouse");if(Fe.supportsNode(e,o,n))return e.startRichTextVariableEditTool(o.id,n,"mouse");if(Se.supportsNode(e,o,n))return e.startStringVariableEditTool(o.id,n,"mouse");if(Re.supportsNode(e,o,n))return e.startCollectionReferenceVariableEditTool(o.id,n,"mouse");if(_e.supportsNode(e,o,n))return e.startEnumVariableEditTool(o.id,n,"mouse")}},[o,n])}function Ed(o,n){let{treeStore:e,projectStore:t,modalStore:r,accessStore:i}=o.stores,s=e.tree.getNodeWithTrait(n,Tn),c=Tn(s)&&go(s)?xi(e.tree,s.dataIdentifier):void 0,l=i.access?.userId;u(l,"User must be logged in"),u(c,"Collection node must exist");let m=vo.create({isDraft:!0,privateToUserId:l});Vo(c,m),e.tree.insertNode(m,c.id,0),t.commitTreeAndSend(),r.set({type:"OnPageCMSFieldsModal",fieldIdsToShow:Ho(c),requiredFieldsOnly:!1,source:"on_page_hud",collectionNodeId:c.id,collectionItemId:m.id})}var me=g(L());var rf="popout_pqnmppj";var Ue=g(x()),Nd=["right","left"],Od={x:15,y:0};function af({tool:o}){let{nodeId:n,renderId:e}=o,[t,r]=(0,me.useState)(null),i=I(),{tree:s}=i.stores.treeStore.useState(),c=s.getNodeWithTrait(n,St);function l(){i.exitTool()}if(c)return(0,Ue.jsx)(H,{tree:s,node:c,renderId:e,ref:r,children:(0,Ue.jsxs)(Po,{anchor:t,alignSelf:"center",attachTo:Nd,offset:Od,onClose:l,showArrow:!0,arrow:{anchor:t,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,children:[(0,Ue.jsx)(ia,{disableDivider:!0,onClose:l,children:(0,Ue.jsx)(aa,{title:"Image"})}),(0,Ue.jsx)("div",{className:rf,children:Oe(c.fillImage)?(0,Ue.jsx)(Bd,{node:c,dynamicValue:c.fillImage,renderId:e}):(0,Ue.jsx)(Ad,{node:c})})]})})}function Bd({node:o,dynamicValue:n,renderId:e}){return u(O(n),"Expected variable reference"),(0,Ue.jsx)(Td,{node:o,variableReference:n,renderId:e})}function Td({node:o,variableReference:n,renderId:e}){let t=I(),r=t.stores.treeStore.useState(p=>{let d=o.cache.getRenderInstance(e);return T(p.tree,p.sandboxCollectionData,n,"image",d?.collectionItemId)});u(r,"Variable info must exist");let{collectionItemNode:i,reducedControlProp:s,controlProp:c}=r;u(s.type==="responsiveimage","Expected reduced responsive image");let l=(0,me.useCallback)(p=>{i.set(An({[n.id]:p(c)})),t.stores.projectStore.commitTreeAndSend()},[i,n,c]),m=(0,me.useCallback)(()=>{i.set(An({[n.id]:{type:"image",value:void 0}})),t.stores.projectStore.commitTreeAndSend()},[i,n]);return(0,Ue.jsx)(Cs,{controlProp:s,onChange:l,onRemove:m,maxExtraImages:0})}function Ad({node:o}){let n=I(),e=(0,me.useMemo)(()=>{let p={...ts(),...rs()};return os(o,p),is(o,p),p},[o]),t=(0,me.useCallback)(async p=>{let[d]=await p;d&&(qa(o,d),n.stores.projectStore.commitTreeAndSend())},[o]),r=(0,me.useCallback)(p=>{ae(o.fillImage)&&(o.set({fillImage:Lr(o.fillImage,p)}),n.stores.projectStore.commitTreeAndSend())},[o]),i=(0,me.useCallback)(p=>{Ii(o)&&(o.set({altAttribute:p}),n.stores.projectStore.commitTreeAndSend())},[o]),s=(0,me.useCallback)(p=>{o.set({fillImageResize:p}),n.stores.projectStore.commitTreeAndSend()},[o]),c=(0,me.useCallback)(p=>{o.set({fillImageTileSize:p}),n.stores.projectStore.commitTreeAndSend()},[o]),l=(0,me.useCallback)((p,d)=>{o.set({fillImagePositionX:p,fillImagePositionY:d}),n.stores.projectStore.commitTreeAndSend()},[o]),m=(0,me.useCallback)(()=>{o.set({fillImage:void 0}),n.stores.projectStore.commitTreeAndSend()},[o]);return(0,Ue.jsx)(us,{...e,imageReferences:e.fillImages,altText:e.altAttribute,onChangeImages:t,onChangeAssetSize:r,onChangeAltText:i,onChangeImageResize:s,onChangeFillImageSize:c,onChangeImagePosition:l,onRemoveImage:m})}var cf=g(L());var sf="warningButton_w1uyyr5z",lf="warningButtonIcon_w1z0oe1i";var ro=g(x());function ff({richTextNode:o,webPageNode:n}){let e=I(),{modalStore:t,treeStore:r}=e.stores,{tree:i}=r.useState();return(0,cf.useMemo)(()=>{let c=i.getNodeWithTrait(o.originalid??o.id,P);return u(c,"originalNode must exist"),n.getTopLevelReplicaVariants().some(l=>{let m=Qt(l.id,c.id),p=i.get(m);return P(p)&&So(i,p,"html")&&p.getTextContent()!==c.getTextContent()})},[i,o,n])?(0,ro.jsxs)(zi,{className:sf,onClick:()=>{e.exitTool(),t.set({richTextNodeId:o.id,source:"on_page_hud",type:"OnPageRichTextVariantOverride"})},children:[(0,ro.jsx)(Xi,{viewBox:"0 0 12 12",className:lf}),(0,ro.jsx)(Le,{children:"Responsive Text"})]}):null}var df="warningContainer_w1v62ead";var pt=g(x());function mf({tool:o}){let{nodeId:n,renderId:e}=o,t=I(),{treeStore:r,toolStore:i}=t.stores,{tree:s}=r.useState(),c=Gt(n),l=s.getNodeWithTrait(n,P),m=ce();return!l||!m||!i.proseMirrorView?null:(0,pt.jsxs)(H,{tree:s,node:l,renderId:e,children:[(0,pt.jsx)(Jr,{isOn:"onPageRichTextBreakpointOverride",children:(0,pt.jsx)("div",{className:df,children:(0,pt.jsx)(ff,{richTextNode:l,webPageNode:m})})}),(0,pt.jsx)(Es,{tool:o,scopeNode:m,node:l,renderId:e,editorView:i.proseMirrorView,zoom:1,handleOutsideClick:p=>{p.target===p.currentTarget&&t.exitTool()},style:{clipPath:c}})]})}var io=g(x());function pf({tool:o}){let{nodeId:n,renderId:e}=o,t=I(),{tree:r}=t.stores.treeStore.useState(),{validationWarning:i}=t.stores.toolStore.useState(),s=Gt(n),c=r.getNodeWithTrait(n,P),l=ce();return!l||!c?null:(0,io.jsxs)(H,{tree:r,node:c,renderId:e,children:[(0,io.jsx)(rn,{validationWarning:i}),(0,io.jsx)(ks,{tool:o,scopeNode:l,node:c,renderId:e,zoom:1,onClickOutside:m=>{m.target===m.currentTarget&&t.exitTool()},hasValidationWarning:!!i,style:{clipPath:s}})]})}var le=g(x());function uf(){let{treeStore:o,sandboxStore:n}=I().stores,{canvasHeight:e}=n.useState(),t=o.useState(r=>r.tree.getPresetsListNode());return(0,le.jsxs)("div",{className:Nc,style:{height:e??"initial"},children:[(0,le.jsx)(kc,{}),(0,le.jsx)(Md,{}),(0,le.jsx)(Qa,{presetsListNode:t})]})}function Md(){let{toolStore:o,canvasStore:n,projectStore:e,modalStore:t}=I().stores,{tool:r}=o.useState(),{finishedEditing:i}=n.useState(),{hasPermanentlyFailed:s}=e.useState(),c=t.useState(l=>l.active.type!=="None");if(!s&&!i&&!c){if(r instanceof ve)return(0,le.jsx)(nf,{});if(r instanceof Ve)return(0,le.jsx)(af,{tool:r});if(r instanceof Ce)return(0,le.jsx)(mf,{tool:r});if(r instanceof Fe)return(0,le.jsx)(Dc,{tool:r});if(r instanceof Se)return(0,le.jsx)(pf,{tool:r});if(r instanceof Me)return(0,le.jsx)(ef,{tool:r});if(r instanceof Re)return(0,le.jsx)(Tc,{tool:r});if(r instanceof _e)return(0,le.jsx)(of,{tool:r});if(r instanceof De)return(0,le.jsx)($c,{tool:r})}}var Ge=g(x());function gf(){At();let o=I(),{isHidden:n}=o.stores.canvasStore.useState();return(0,cn.useEffect)(()=>{let e=({data:t})=>{if(Qe(t)&&t.apiVersion===1){let{type:r,position:i}=t;r==="showCanvas"&&Qe(i)&&Xr(i.top)&&(window.scrollTo({behavior:"instant",top:i.top}),setTimeout(()=>{o.stores.canvasStore.isHidden=!1,o.startHighlightTool(),o.stores.editableNodeHighlightStore.highlight(o,{type:"start"})},0))}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,cn.useEffect)(()=>{let{sandboxStore:e}=o.stores;n?e.hide():e.show()},[n]),_d(n),el({channel:Vr,toast:ft}),(0,Ge.jsx)(Qi,{children:(0,Ge.jsxs)("div",{className:X(n&&ll),children:[(0,Ge.jsx)(uf,{}),(0,Ge.jsxs)("div",{className:cl,[Zn]:"true",children:[(0,Ge.jsx)(ic,{}),(0,Ge.jsx)(Hl,{}),(0,Ge.jsx)(ua,{padding:80}),(0,Ge.jsx)(Qs,{ref:o.stores.projectStore.filePickerRef})]})]})})}function _d(o){let n=I();(0,cn.useEffect)(()=>{if(o)return;let e=new gs;e.set("CommandOrControl+Z",n.undo.bind(n),"undo"),e.set("CommandOrControl+Shift+Z",n.redo.bind(n),"redo");function t(r){if(Ao())return;let i=e.get(r);i&&(i.action(r),r.preventDefault(),r.stopPropagation())}return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[o])}var yf=g(L());function hf(){(0,yf.useEffect)(()=>{let o=n=>{if(!Qe(n.data))return;let{apiVersion:e,type:t}=n.data;e===1&&t==="enterOnPageEditing"&&Be("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-enter-on-page-editing"})};return window.addEventListener("message",o),()=>window.removeEventListener("message",o)},[])}var br=g(L());var Wt="https://app.framerstatic.com/framer-logo-blue-23OMXQLR.png";var dn="button_b9jl8lf",mn="editorBarButtonPrimary_eptse9g";var Cf="backdrop_bzafg2a",wf="container_cnhgigm",xf="textContainer_t1ookr3o",Uf="title_tyol4w7",If="subtitle_s7fryoi",bf="button_by9jupw",Ff="buttonsContainer_b18g1n4a",Sf="closeModal_c1gc3a0q";var qt=g(x());function vf({width:o=10,height:n=10,className:e}){return(0,qt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:n,fill:"none",className:e,"aria-hidden":"true",children:(0,qt.jsxs)("g",{transform:"translate(2 2)",children:[(0,qt.jsx)("path",{d:"M 0 0 L 6 6",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),(0,qt.jsx)("path",{d:"M 0 6 L 6 0",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})}var pe=g(x());function zd({children:o,onClick:n,disabled:e,layoutId:t,duration:r}){return(0,pe.jsx)(Ne.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:r,type:"spring",bounce:.2,delay:0},children:(0,pe.jsx)(G,{type:"button",className:bf,onClick:n,enabled:!e,children:o})})}function Lt({logo:o,title:n,subtitle:e,buttons:t,showLearnMoreButton:r}){let i=()=>{window.open("https://www.framer.com/help/articles/on-page-editing","_blank")},s=()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*"),window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*")};return(0,pe.jsx)(he,{className:Cf,onClick:s,children:(0,pe.jsxs)(he,{className:wf,justifyContent:"center",alignItems:"center",onClick:c=>c.stopPropagation(),children:[(0,pe.jsx)(he,{onClick:s,className:Sf,children:(0,pe.jsx)(vf,{})}),(0,pe.jsxs)(he,{className:xf,gap:15,alignItems:"center",justifyContent:"center",children:[o,(0,pe.jsxs)(he,{gap:5,alignItems:"center",justifyContent:"center",children:[(0,pe.jsx)(Ne.span,{layout:!0,className:Uf,children:n}),(0,pe.jsx)(Ne.p,{layout:!0,className:If,children:e})]})]}),t||r?(0,pe.jsxs)(he,{className:Ff,gap:10,children:[r?(0,pe.jsx)(zd,{onClick:i,children:"Learn More"}):null,t||null]}):null]})})}var pn=g(x());function Pf(){let o=I();Bt("editor_bar_impression",{page:"editor-bar-cookie-prompt"});async function n(){Be("editor_bar_interaction",{page:"editor-bar-cookie-prompt",id:"editor-bar-allow-cookies"});try{await document.requestStorageAccess()}finally{await o.stores.accessStore.refresh()}}return(0,pn.jsx)(Lt,{logo:(0,pn.jsx)("img",{decoding:"async",width:36,src:Wt,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Continuing may require granting permissions in a browser dialog.",buttons:(0,pn.jsx)(G,{className:X(dn,mn),onClick:n,variant:"primary",children:"Continue"}),showLearnMoreButton:!0})}var xr=g(x());function Ef({children:o,onClick:n,disabled:e,layoutId:t,duration:r,className:i}){return(0,xr.jsx)(Ne.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:r,type:"spring",bounce:.2,delay:0},children:(0,xr.jsx)(G,{type:"button",className:X(dn,i),onClick:n,enabled:!e,children:o})})}var kf="loginButtonLoading_l4nhz4u";var Kt=g(x());function Nf(){let o=I(),{isLoginInProgress:n}=o.stores.loginStore.useState();Bt("editor_bar_impression",{page:"editor-bar-guest-page"});async function e(){Be("editor_bar_interaction",{page:"editor-bar-guest-page",id:"editor-bar-login"}),await o.stores.loginStore.login()}return(0,Kt.jsx)(Lt,{logo:(0,Kt.jsx)("img",{decoding:"async",width:36,height:36,src:Wt,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Edit the page directly in the browser, without opening the app.",buttons:(0,Kt.jsx)(Ef,{onClick:e,disabled:n,className:mn,children:n?(0,Kt.jsx)("div",{className:kf,children:(0,Kt.jsx)(Js,{})}):"Continue"}),showLearnMoreButton:!0})}var Ur=g(x()),qd="Page Edit",Ld="To edit, ask the site owner for access to the project",Kd="To edit, ask the site owner for content editing permissions";function Ir({reason:o}){return Bt("editor_bar_impression",{page:"editor-bar-no-access-page"}),(0,Ur.jsx)(Lt,{logo:(0,Ur.jsx)("img",{decoding:"async",width:36,src:Wt,alt:"Framer Logo"}),title:qd,subtitle:o==="no-permission"?Kd:Ld,showLearnMoreButton:!0})}var ao=g(x());function Of(){let o=I(),{access:n}=o.stores.accessStore.useState();switch(n.status){case"no-auth":return(0,ao.jsx)(Nf,{});case"unknown":return(0,ao.jsx)(Pf,{});case"no-access":return(0,ao.jsx)(Ir,{reason:"no-access"});case"no-permission":return(0,ao.jsx)(Ir,{reason:"no-permission"});case"success":case"error":return null;default:Ht(n)}}var ut=g(x());function Bf(){let o=I(),{shouldRenderOnPageCanvas:n}=o.stores.accessStore.useState(),e=Te(()=>o.stores.routeStore.webPageNodeId,[],[o.stores.routeStore]);return(0,br.useEffect)(()=>{e&&o.stores.sandboxStore.waitForInitialLoad(e).then(()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*")}).catch(ee)},[e]),(0,br.useEffect)(()=>{o.performanceTracker.reportEditorBarReady()}),hf(),(0,ut.jsxs)(ut.Fragment,{children:[(0,ut.jsx)(Of,{}),n&&(0,ut.jsx)(gf,{})]})}var un=class{constructor(n){this.engine=n;h(this,"state",0);h(this,"changes",new ma)}get inRendering(){return this.state===3}render(){if(this.state!==1)return;let n=this.changes,e=this.engine.stores;try{this.state=2,n.has(e.treeStore,e.routeStore)&&To(e.treeStore.tree,e.treeStore.layoutCache,e.treeStore.sandboxCollectionData,e.treeStore.sandboxVisibility,Q.activeBundleHash,e.routeStore.localeId,void 0,e.routeStore.webPageNodeId),e.toolStore.tool?.update?.(),e.undoRedoManager.processScheduledEndUndoGroup({}),this.state=3,e.sandboxStore.update(),n.signalAllObservers(),Fc()}finally{this.state=0}}signalChanges(n){if(this.changes.addChanges(n),this.state!==0)return;this.state=1;let e=this.render.bind(this);setTimeout(e,0),bc()}wrapHandler(n,e){let{projectStore:t}=this.engine.stores;return function(...r){let i=n.apply(this,r);return t.commitTreeAndSend(e!=="nonUserEvent"),i}}process(n,e){this.wrapHandler(n,e)()}processWhenReady(n,e){this.wrapHandler(n,e)()}async processWhenReadyAsync(n,e){return this.wrapHandler(n,e)()}runWhenIdle(n){requestIdleCallback(n)}runWithFullyLoadedTree(n,e){u(e.runInBackground,"Only background tasks are supported in the OnPageEngine for now.");let t=this.engine.tree.getService("loader"),r=()=>{n(),this.engine.stores.projectStore.commitTreeAndSend()};if(!t)return r(),tt;let i=t.prioritizeLoadingAllData({operationName:e.name,operationInBackground:!0,doNotTrack:e.doNotTrack}),s=t.afterAllDataLoaded(r);return()=>{i(),s()}}runBeforeNextFrame(n){requestAnimationFrame(n)}};var gn=class extends K{constructor(e,t,r){super();this.projectStore=e;this.hostnameStore=t;this.siteId=r;h(this,"_access")}get access(){return u(this._access,"Access not initialized"),this._access}get projectId(){return Tf(this.access)}get canEditContent(){let e=this.access;return e.status!=="success"?!1:e.data.permissions?.canEditContent==="on"}get shouldRenderOnPageCanvas(){return Yn()&&this.canEditContent}async set(e){if(this._access=e,this.shouldRenderOnPageCanvas){let t=Tf(e);e.userId&&t&&(this.projectStore.loadProject(e.userId,t),this.hostnameStore.loadHostnames(t).catch(ee))}Ei.setUserId(e.userId??"null")}async refresh(){let e=await $s(this.siteId);await this.set(e)}},Xd=/^(?<name>.+--)?(?<id>[a-z0-9]{20})(?<hash>-[a-z0-9]+)?$/iu;function Tf(o){if(o.status==="success")return Xd.exec(o.data.projectSlug)?.groups?.id}var Af,Rf,gt,Fr,Sr;Rf=[de()],Af=[de()];var yt=class{constructor(n){this.scheduler=n;J(this,Fr,M(gt,8,this,[])),M(gt,11,this);J(this,Sr,M(gt,12,this)),M(gt,15,this);h(this,"assetMap",new Wr)}get assets(){return this._assets}get assetService(){return this._assetService}setAssetService(n){this._assetService=n,qr(n,e=>{e.assets&&(this._assets=e.assets,this.assetMap.set(e.assets),Je.importCustomFonts(e.assets,$e.isOn("customFontImprovements")))})}};gt=je(null),Fr=new WeakMap,Sr=new WeakMap,ie(gt,4,"_assets",Rf,yt,Fr),ie(gt,4,"_assetService",Af,yt,Sr),Ye(gt,yt);async function Df(o){return fa.post("/edit/notifications/page-edited",o)}var yn=class extends K{constructor(e,t,r,i,s,c,l,m){super();this.accessStore=e;this.routeStore=t;this.treeStore=r;this.projectStore=i;this.modalStore=s;this.undoRedoManager=c;this.exitTool=l;this.onChangeRoute=m;h(this,"isHidden",!0);h(this,"finishedEditing",null);h(this,"_screenWidth",window.innerWidth);h(this,"_temporaryCollectionItemNodeId");window.addEventListener("resize",()=>{this._screenWidth=window.innerWidth})}get screenWidth(){return this._screenWidth}get temporaryCollectionItemNodeId(){return this._temporaryCollectionItemNodeId}set temporaryCollectionItemNodeId(e){this._temporaryCollectionItemNodeId=e,this.onChangeRoute()}async sendNotification(e){let t=this.accessStore.projectId;u(t,"Project ID must exist");let r=Ke(this.routeStore,this.treeStore);u(r,"Web page node must exist");let i=Ae(this.routeStore,this.treeStore,this),s;if(i){let c=Dt(this.routeStore,this.treeStore,this);u(c,"Collection item exists, so its parent collection must exist"),u(c.name,"Collection node must have a name"),s={notificationType:e,projectId:t,webPageNodeId:r.id,collectionItemNodeId:i.id,collectionItemTitle:Zd(c,i),collectionTitle:c.name,pageType:"cms-detail"}}else s={notificationType:e,projectId:t,webPageNodeId:r.id,pageTitle:r.webMetadata?.title||xa(this.treeStore.tree,r),pageType:"static"};await Df(s)}createTemporaryCollectionItem(){let e=Dt(this.routeStore,this.treeStore,this);if(!e)return;let t=this.accessStore.access?.userId;u(t,"User must be logged in");let r=e.getPrivateItemForUser(t);if(r)this.temporaryCollectionItemNodeId=r.id;else{let i=vo.create({isDraft:!0,privateToUserId:t});this.treeStore.tree.insertNode(i,e.id,0),this.temporaryCollectionItemNodeId=i.id,Vo(e,i),this.projectStore.commitTreeAndSend()}}discardTemporaryCollectionItem(){let e=Ae(this.routeStore,this.treeStore,this);u(e,"Collection item node must exist"),u(e.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),this.treeStore.tree.remove(e.id),this.projectStore.commitTreeAndSend(),this.clearTemporaryItem(),this.exitFullscreen()}saveTemporaryCollectionItem(){let e=Ae(this.routeStore,this.treeStore,this);u(e,"Collection item node must exist"),u(e.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),e?.set({privateToUserId:void 0}),this.projectStore.commitTreeAndSend(),this.finishEditingWithChanges(e.id,!0)}handleFinishEditing(){this.exitTool();let e=Ae(this.routeStore,this.treeStore,this);if(!!!e?.privateToUserId){if(!this.treeStore.hasChanged()){this.handleDismissFinishEditing();return}let m=this.routeStore.projectLinkNodeId;if(!m)return;this.finishEditingWithChanges(m,!1);return}let r=Dt(this.routeStore,this.treeStore,this);if(u(r&&e,"Collection node and collection item node must exist"),!e.hasData()){this.discardTemporaryCollectionItem();return}let i=Ro(r,e);ds(r,e,i)&&this.projectStore.commitTreeAndSend();let l=fs(this.treeStore.tree,r,e,i).flatMap(m=>{let p=m.type;return cr[p]!==void 0?m.id:[]});l.length>0?this.modalStore.set({type:"OnPageCMSFieldsModal",fieldIdsToShow:l,requiredFieldsOnly:!0,source:"on_page_hud",collectionItemId:e.id,collectionNodeId:r.id}):this.saveTemporaryCollectionItem()}finishEditingWithChanges(e,t){this.finishedEditing={isNewItem:t,nodeId:e},Be("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-finish-editing-with-changes"});let r=t?"page-created":"page-edited";this.sendNotification(r).catch(ee)}handleDismissFinishEditing(){this.clearTemporaryItem(),this.undoRedoManager.clearUndoStack(),this.exitFullscreen()}exitFullscreen(){window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*"),this.isHidden=!0}clearTemporaryItem(){this.finishedEditing=null,this.temporaryCollectionItemNodeId=void 0}};function Zd(o,n){let e=o.variables.find(ct);if(e?.associatedStringVariable){let t=n.getControlProp(e.associatedStringVariable);if(t&&t.type==="string"&&ae(t.value)&&t.value.trim())return t.value.trim()}return"a new page"}var hn=class{updateComponentLoader(n,e){Q.setModuleRevision(e,0);for(let t of n)Q.updateEntity(t.identifier,t)}};var jd=0,Mf,Cn,vr,Zt;Mf=[de()];var Xt=class{constructor(n){this.scheduler=n;J(this,vr,M(Cn,8,this)),M(Cn,11,this);J(this,Zt);window.addEventListener("resize",()=>{this._editableNodesHighlight&&(this._editableNodesHighlight=void 0)})}get editableNodesHighlight(){return this._editableNodesHighlight}onChangeRoute(){this._editableNodesHighlight&&(this._editableNodesHighlight=void 0)}cleanupAnimationOnFinish(n){He(this,Zt)&&clearTimeout(He(this,Zt)),Yt(this,Zt,window.setTimeout(()=>{this._editableNodesHighlight=void 0},n+100))}highlight(n,{type:e}){let t=xe(n.stores.routeStore,n.stores.treeStore,n.stores.canvasStore);if(!t)return;let r=[],i={x:0,y:window.scrollY,width:window.innerWidth,height:window.innerHeight},s=1/0,c=-1/0,l=!1;for(let m of t.walk())for(let[p]of m.cache.iterateRenderInstances()){if(!ve.isSelectableNode(n,m,p))continue;l=!0;let d=n.tree.convertFrameToCanvas(m,void 0,p);if(!Yd(i,d))continue;s=Math.min(s,d.y),c=Math.max(c,d.y+d.height);let f=n.tree.getRect(m,void 0,void 0,void 0,p),a=n.tree.transformMatrixToNode(m,void 0,void 0,p);r.push({renderId:p,width:f.width,height:f.height,transform:a.toString(),centerX:d.x+d.width/2,centerY:d.y+d.height/2})}if(r.length===0)ft({key:"editable-nodes-highlight-empty",type:"add",text:l?"Editable content is out of view, scroll to reveal it":"Content is not editable on this page",variant:"info"}),this._editableNodesHighlight=void 0;else{let m=e==="clickOnVoid",p=m?n.stores.mouseStore.windowMousePosition.x:i.width,d=m?n.stores.mouseStore.windowMousePosition.y:i.height/2,f=m?n.stores.mouseStore.canvasMousePosition.y:n.stores.mouseStore.scrollPosition.y,a=400,w=Math.max(p,window.innerWidth-p),y=Math.max(d,window.innerHeight-d),C=Math.sqrt(w**2+y**2)+a,b=Math.max(500,e==="clickOnVoid"?C:C*2),F=5,v=Math.max(0,Math.floor(s-F)),U=Math.ceil(c+F),S=Hd(r,C,p,f);this._editableNodesHighlight={animationId:`editable-nodes-highlight-${jd++}`,minY:v,maxY:U,originX:p,originY:d-v+i.y,highlights:r,minRadius:S,maxRadius:C,gradientSize:a,animationDuration:b},this.cleanupAnimationOnFinish(b)}}};Cn=je(null),vr=new WeakMap,Zt=new WeakMap,ie(Cn,4,"_editableNodesHighlight",Mf,Xt,vr),Ye(Cn,Xt);function Yd(o,n){return!(n.x>=ke.maxX(o)||ke.maxX(n)<=o.x||n.y>=ke.maxY(o)||ke.maxY(n)<=o.y)}function Hd(o,n,e,t){let r=1/0;for(let i of o){let s=Math.sqrt(i.width**2+i.height**2),c=Math.abs(i.centerX-e),l=Math.abs(i.centerY-t),m=Math.sqrt(c**2+l**2),p=Math.max(0,m-s/2);r=Math.min(r,p)}return Number.isFinite(r)&&r<n?r:0}var wn=class extends Wa{constructor(){super(...arguments);h(this,"hostnames")}get customHostnameString(){return this.hostnames?.find(e=>e.type==="custom")?.hostname}get defaultHostnameString(){return this.hostnames?.find(e=>e.type==="default")?.hostname}async loadHostnames(e){let{hostnames:t}=await za(e);this.hostnames=t}};var xn=class extends K{constructor(e){super();this.sandboxStore=e}async ensureModuleEvaluatedInSandbox(e){await(await this.sandboxStore.getModulesRuntime()).loadModule(e.value)}hasModuleForIdentifier(e){return!!Q.componentForIdentifier(e.value)}};var Un=class extends K{constructor(e){super();this.accessStore=e;h(this,"isLoginInProgress",!1)}login(){let e=window.open(`${mo().login}?closeAfterSuccess=true`,"_blank");return e?this.startLoginWindowClosedPolling(e):Promise.resolve()}startLoginWindowClosedPolling(e){return this.isLoginInProgress=!0,new Promise(r=>{let i=setInterval(async()=>{e.closed&&(clearInterval(i),await this.accessStore.refresh(),this.isLoginInProgress=!1,r())},500)})}};var _f,Vf,Gf,zf,Wf,qf,$,Pr,Er,kr,Nr,Or;qf=[de()],Wf=[de(We.isEqual)],zf=[de(We.isEqual)],Gf=[Ic(We.isEqual)],Vf=[de()],_f=[de()];var Pe=class{constructor(n){this.scheduler=n;M($,5,this);J(this,Pr,M($,8,this)),M($,11,this);J(this,Er,M($,12,this,We(0,0))),M($,15,this);J(this,kr,M($,16,this,We(0,0))),M($,19,this);J(this,Nr,M($,20,this,!1)),M($,23,this);J(this,Or,M($,24,this,!1)),M($,27,this);let e=this.onMouseMove.bind(this);document.addEventListener("mousemove",e);let t=this.onScroll.bind(this);document.addEventListener("scroll",t)}get lastUpdateType(){return this._lastUpdateType}get scrollPosition(){return this._scrollPosition}get windowMousePosition(){return this._windowMousePosition}get canvasMousePosition(){return We.add(this.windowMousePosition,this.scrollPosition)}get isHoveringChrome(){return this._isHoveringChrome}get isHoveringFloatingCanvasChrome(){return this._isHoveringFloatingCanvasChrome}onScroll(){this._scrollPosition=We(window.scrollX,window.scrollY),this._lastUpdateType="scroll"}onMouseMove(n){this._isHoveringChrome=il(n.target),this._isHoveringFloatingCanvasChrome=al(n.target),this._windowMousePosition=We(n.clientX,n.clientY),this._lastUpdateType="mouseMove"}};$=je(null),Pr=new WeakMap,Er=new WeakMap,kr=new WeakMap,Nr=new WeakMap,Or=new WeakMap,ie($,4,"_lastUpdateType",qf,Pe,Pr),ie($,4,"_scrollPosition",Wf,Pe,Er),ie($,4,"_windowMousePosition",zf,Pe,kr),ie($,2,"canvasMousePosition",Gf,Pe),ie($,4,"_isHoveringChrome",Vf,Pe,Nr),ie($,4,"_isHoveringFloatingCanvasChrome",_f,Pe,Or),Ye($,Pe);var In=class extends K{constructor(){super(...arguments);h(this,"colorModel","HEX")}};var Lf=g(L());var bn=class extends K{constructor(e,t){super();this.assetStore=e;this.treeStore=t;h(this,"_hasPermanentlyFailed",!1);h(this,"project");h(this,"projectPromise",new It);h(this,"filePickerRef",(0,Lf.createRef)())}get hasPermanentlyFailed(){return this._hasPermanentlyFailed}getProject(){return this.projectPromise}get resourceLimits(){}get featureFlags(){}get projectLicenseType(){return"freeSite"}loadProject(e,t){At(),!this.project&&(this.project=new ol(this.treeStore.timeline,e,t),this.project.connect(),this.project.document.on("disconnect",this.onDisconnect,this),this.project.connection.on("disconnect",this.onDisconnect,this),this.project.document.on("update",r=>{this.treeStore.newTreeAfterRemoteUpdate(r)}),this.assetStore.setAssetService(this.project.assetService),this.projectPromise.resolve(this.project))}onDisconnect(e){Xa(e)||(this._hasPermanentlyFailed=!0,e==="ClientNeedsUpdate"?ft({type:"add",variant:"warning",text:"A new version of Framer is available. Please reload the page to continue working.",key:"client-outdated",duration:1/0,icon:"warning",showCloseButton:"never"}):ft({type:"add",variant:"error",text:"Connection error: "+e,key:"connection-error",duration:1/0,icon:"error",showCloseButton:"never"}))}commitTreeAndSend(e=!0){u(this.project,"Project must be initialized"),u(!this.hasPermanentlyFailed,"Project is permanently failed");let t=this.treeStore.timeline.commitLocalTree();this.treeStore.newTreeAfterLocalUpdate(t,e),this.project.maybeSend()}};var Kf,Xf,ht,Br,Tr;Xf=[de()],Kf=[de()];var Ct=class{constructor(n,e){this.scheduler=n;this.onChangeRoute=e;h(this,"localeId",li);J(this,Br,M(ht,8,this)),M(ht,11,this);J(this,Tr,M(ht,12,this)),M(ht,15,this);let t=({data:r})=>{if(Qe(r)&&r.apiVersion===1){let{type:i,nodeIds:s}=r;if(i==="updateNodeIds"&&Qe(s)&&ae(s.webPageNodeId)){let{webPageNodeId:c,collectionItemNodeId:l}=s;this._webPageNodeId=c,this._collectionItemNodeId=ae(l)?l:void 0,this.onChangeRoute()}}};window.addEventListener("message",t),window.parent.postMessage({apiVersion:1,type:"initializeComponent",component:"OnPageActiveRouteStore"},"*")}get collectionItemNodeId(){return this._collectionItemNodeId}get webPageNodeId(){return this._webPageNodeId}get projectLinkNodeId(){return this._collectionItemNodeId??this._webPageNodeId}};ht=je(null),Br=new WeakMap,Tr=new WeakMap,ie(ht,4,"_collectionItemNodeId",Xf,Ct,Br),ie(ht,4,"_webPageNodeId",Kf,Ct,Tr),Ye(ht,Ct);var Zf="iframe_icxp2h1";var Fn=class extends K{constructor(e,t,r,i){super();this.componentsStore=e;this.treeStore=t;this.performanceTracker=r;this.updateGenerator=i;h(this,"config",ga.onPageCanvas);h(this,"iframe");h(this,"remoteSandbox");h(this,"remoteControlsVisibility",new It);h(this,"remoteModulesRuntime",new It);h(this,"_canvasHeight");h(this,"webPageNodeIdToInitialLoadPromise",new Map);window.addEventListener("scroll",()=>{this.remoteSandbox?.scrollTo({behavior:"instant",top:window.scrollY})})}getControlsVisibility(){return this.remoteControlsVisibility}getModulesRuntime(){return this.remoteModulesRuntime}get canvasHeight(){return this._canvasHeight}loadSandbox(){At(),u(!this.iframe,"Sandbox already loaded");let e=document.createElement("iframe");e.src=this.config.url,e.allow=ws,e.sandbox.add("allow-scripts","allow-same-origin"),e.tabIndex=-1,e.id="canvas_sandbox",e.className=Zf;let t=this.initializeSandbox.bind(this,e);e.addEventListener("load",t),this.iframe=e,this.hide(),document.body.append(e)}getInitialLoadPromise(e){let t=this.webPageNodeIdToInitialLoadPromise.get(e)??new It;return this.webPageNodeIdToInitialLoadPromise.set(e,t),t}async waitForInitialLoad(e){this.performanceTracker.reportCanvasLoaderViewed(),await this.getInitialLoadPromise(e)}async initializeSandbox(e){let t=e.contentWindow;u(t,"Sandbox didn't load correctly");let r=new ya(ot);r.setLocal(ot.channels.componentsStore,this.componentsStore),r.setLocal(ot.channels.sandboxStore,this),r.setLocal(ot.channels.treeStore,this.treeStore);let i=r.getRemote(ot.channels.sandbox),s=r.getRemote(ot.channels.controlsVisibility),c=r.getRemote(ot.channels.modulesRuntime);await r.connect({target:t,url:this.config.origin}),this.remoteSandbox=i,this.remoteControlsVisibility.resolve(s),this.remoteModulesRuntime.resolve(c)}onHeightChange(e){this._canvasHeight=e}onInitialLoadComplete(e){this.performanceTracker.reportCanvasReady(),this.getInitialLoadPromise(e).resolve()}update(){let e=this.remoteSandbox;if(!e)return;let t=this.updateGenerator.getUpdate();fo(t)||e.update(t)}hide(){u(this.iframe,"Sandbox not loaded"),this.iframe.setAttribute("aria-hidden","true")}show(){u(this.iframe,"Sandbox not loaded"),this.iframe.removeAttribute("aria-hidden")}};var Sn=class extends K{constructor(e,t){super();this.routeStore=e;this.treeStore=t}get active(){let e=Ke(this.routeStore,this.treeStore);return A(e,"webPageNode must be defined"),e}};var wt,so,vn=class extends K{constructor(e,t){super();this.treeStore=e;this.mouseStore=t;h(this,"highlightedRenderId");h(this,"nodeInTextEditor");h(this,"proseMirror");h(this,"proseMirrorView",null);J(this,wt);J(this,so);h(this,"validationWarning")}get tool(){return He(this,wt)}set tool(e){Yt(this,so,this.mouseStore.windowMousePosition),He(this,wt)!==e&&(He(this,wt)?.stop?.(),Yt(this,wt,e))}get windowMousePositionOnToolEntry(){return He(this,so)}validateCollectionControl(e){let t="required";if(!e)return;let{collectionItemNode:r,variableDefinition:i,collectionNode:s,controlDescription:c,controlProp:l}=e,m;(ho(i)||ct(i))&&(m=Do(i,s.variables,r));let p=Ro(s,r),d=i.type,f=Mo(d,c,l,m,void 0,Co(i),p.get(i.id));this.validationWarning=f?.type===t?void 0:f}};wt=new WeakMap,so=new WeakMap;var Pn=class extends K{constructor(e,t){super();this.routeStore=e;this.undoRedoManager=t;h(this,"layoutCache",new Ta);h(this,"sandboxCollectionData",new Aa("editor"));h(this,"sandboxVisibility",new Ra("editor"));h(this,"_tree",Mi.createEmpty());h(this,"_domLayoutUpdate",0);h(this,"timeline",new Da(this.tree));h(this,"treeIndexes",new Ar(this))}get tree(){return this._tree}get domLayoutUpdate(){return this._domLayoutUpdate}get remoteTreeVersion(){return this.timeline.remoteTreeVersion}getChangesForUndo(){let e=this.timeline.getLatestChangesForUndo();return e?e.filter(t=>!t.ignoreInUndo):[]}hasChanged(){return this.undoRedoManager.getUndoBufferSize()>0}getPartialIndexes(){return this.treeIndexes}getLoadedIndexes(){let e=this.tree.getService("loader");if(e){let t=e.numberOfScopesToLoad();throw new Error(`Some scopes are still loading: ${t} scopes left to load`)}return this.treeIndexes}onLayoutMeasure(e){let t=this.layoutCache.processLayoutMeasurements(e);t.size===0||_a(this.tree,this.layoutCache,t).size===0||this._domLayoutUpdate++}onSandboxRendered(e){let t=new Set;if(e.collectionUpdates){let r=this.sandboxCollectionData.import(e.collectionUpdates);for(let i of r){let s=$t(i);t.add(s)}}if(e.visibilityUpdates){let r=this.sandboxVisibility.import(e.visibilityUpdates);for(let i of r){let s=$t(i);t.add(s)}}if(t.size>0){let r=Ma(this.tree,t);To(this.tree,this.layoutCache,this.sandboxCollectionData,this.sandboxVisibility,Q.activeBundleHash,this.routeStore.localeId,void 0,r)}e.layoutMeasurements&&this.onLayoutMeasure(e.layoutMeasurements)}newTreeAfterRemoteUpdate(e){e.inEditor=!0,this._tree!==e&&(this._tree=e)}newTreeAfterLocalUpdate(e,t){if(e.inEditor=!0,this._tree===e)return;this._tree=e;let r=this.getChangesForUndo();t&&r.length>0&&this.undoRedoManager.addUndoEntry({changes:r})}},Ar=class{constructor(n){this.treeStore=n;h(this,"codeComponentNodeCache");h(this,"richTextNodeCache")}get codeComponents(){let n=this.treeStore.tree;if(this.codeComponentNodeCache?.tree===n)return this.codeComponentNodeCache.codeComponentNodes;let e=[];for(let t of n.root.walk())be(t)&&e.push(t);return this.codeComponentNodeCache={tree:n,codeComponentNodes:e},e}get richTextNodes(){let n=this.treeStore.tree;if(this.richTextNodeCache?.tree===n)return this.richTextNodeCache.richTextNodes;let e=[];for(let t of n.root.walk())P(t)&&e.push(t);return this.richTextNodeCache={tree:n,richTextNodes:e},e}};var En=class extends La{};var kn=class{constructor(n,e,t){h(this,"accessStore");h(this,"assetStore");h(this,"canvasStore");h(this,"componentsStore");h(this,"contextMenuStore");h(this,"editableNodeHighlightStore");h(this,"hostnameStore");h(this,"loadedExternalModulesStore");h(this,"loginStore");h(this,"modalStore");h(this,"modulesStore");h(this,"mouseStore");h(this,"persistedUserDefaults");h(this,"projectStore");h(this,"routeStore");h(this,"sandboxStore");h(this,"scopeStore");h(this,"toolStore");h(this,"treeStore");h(this,"undoRedoManager",new En);h(this,"vectorsStore");this.assetStore=new yt(e),this.editableNodeHighlightStore=new Xt(e),this.routeStore=new Ct(e,()=>n.onChangeRoute()),this.componentsStore=new hn,this.contextMenuStore=Ga.new(e,e),this.hostnameStore=wn.new(e),this.modalStore=da.new(e,e),this.treeStore=Pn.new(e,this.routeStore,this.undoRedoManager),this.projectStore=bn.new(e,this.assetStore,this.treeStore),this.accessStore=gn.new(e,this.projectStore,this.hostnameStore,t),this.loginStore=Un.new(e,this.accessStore),this.mouseStore=new Pe(e),this.toolStore=vn.new(e,this.treeStore,this.mouseStore),this.canvasStore=yn.new(e,this.accessStore,this.routeStore,this.treeStore,this.projectStore,this.modalStore,this.undoRedoManager,()=>n.exitTool(),()=>n.onChangeRoute()),this.scopeStore=Sn.new(e,this.routeStore,this.treeStore),this.sandboxStore=Fn.new(e,this.componentsStore,this.treeStore,n.performanceTracker,n.sandboxUpdateGenerator),this.loadedExternalModulesStore=xn.new(e,this.sandboxStore),this.modulesStore=Na.new(e,e,this.treeStore,this.loadedExternalModulesStore,{codeEditorPreviewVisible:!1,mainView:0},this.projectStore.getProject().then(r=>r.modulesAPI),()=>{throw new Error("Can't make document readonly")},async r=>{await(await this.sandboxStore.getModulesRuntime()).insertTemporaryImportMap(r)},async()=>{throw new Error("Can't load all local modules")}),this.persistedUserDefaults=In.new(e),this.vectorsStore=Ka.new(e,this.modulesStore)}};var Nn=class{constructor(){h(this,"editorBarReadyAt");h(this,"canvasReadyAt");h(this,"canvasLoaderViewedAt")}get editorBarReadyMs(){let n=Qd();if(!(se(n)||se(this.editorBarReadyAt)))return this.editorBarReadyAt-n}get canvasReadyMs(){if(!(se(this.canvasReadyAt)||se(this.editorBarReadyAt)))return this.canvasReadyAt-this.editorBarReadyAt}get perceivedCanvasLoadMs(){if(!se(this.canvasReadyAt))return se(this.canvasLoaderViewedAt)?0:Math.min(this.canvasReadyAt-this.canvasLoaderViewedAt,0)}reportEditorBarReady(){this.editorBarReadyAt=Date.now()}reportCanvasLoaderViewed(){this.canvasLoaderViewedAt=Date.now()}reportCanvasReady(){this.canvasReadyAt=Date.now(),this.sendCanvasLoadedEvent()}sendCanvasLoadedEvent(){let{canvasReadyMs:n,editorBarReadyMs:e,perceivedCanvasLoadMs:t}=this;se(n)||se(e)||se(t)||Be("editor_bar_canvas_loaded",{editorBarReadyMs:e,canvasReadyMs:n,perceivedCanvasLoadMs:t})}};function Qd(){let o=new URLSearchParams(window.location.search).get("loadStart");if(!o)return;let n=Number(o);if(!Number.isNaN(n))return n}var On=class{constructor(n){this.engine=n;h(this,"partialTreeSender");h(this,"previousWebPageNodeId");h(this,"previousCollectionItemNodeId");h(this,"previousBreakpointNodeId");h(this,"previousTemporaryCollectionItemNodeId");h(this,"previousStylePresetBreakpointClassNames");h(this,"previousLocalModules");h(this,"previousDependenciesModule");h(this,"previousAssets");h(this,"previousNodeInTextEditor")}getUpdate(){let{canvasStore:n,modulesStore:e,routeStore:t,assetStore:r,treeStore:i,toolStore:s}=this.engine.stores,c={},l=Ke(t,i)?.id;l!==this.previousWebPageNodeId&&(this.previousWebPageNodeId=l,c.webPageNodeId=l);let m=Ae(t,i,n)?.id;m!==this.previousCollectionItemNodeId&&(this.previousCollectionItemNodeId=m,c.collectionItemNodeId=m);let p=xe(t,i,n)?.id;p!==this.previousBreakpointNodeId&&(this.previousBreakpointNodeId=p,c.breakpointNodeId=p);let d=n.temporaryCollectionItemNodeId??null;d!==this.previousTemporaryCollectionItemNodeId&&(this.previousTemporaryCollectionItemNodeId=d,c.temporaryCollectionItemNodeId=d);let f=i.tree.getPresetsListNode(),a=$d(f,n.screenWidth);a!==this.previousStylePresetBreakpointClassNames&&(this.previousStylePresetBreakpointClassNames=a,c.stylePresetBreakpointClassNames=a);let w=e.localModules;w!==this.previousLocalModules&&(this.previousLocalModules=w,c.localModules=new Map(w));let y=e.dependenciesModule;y!==this.previousDependenciesModule&&(this.previousDependenciesModule=y,c.dependenciesModule=y);let C=r.assets;C!==this.previousAssets&&(this.previousAssets=C,c.assets=C),this.partialTreeSender??=new ha(i.timeline,"canvas");let b=this.partialTreeSender.update(l);fo(b)||(c.partialTreeUpdate=b);let F=s.nodeInTextEditor??null;return F!==this.previousNodeInTextEditor&&(this.previousNodeInTextEditor=F,c.nodeInTextEditor=F),c}},$d=ei((o,n)=>{let e=xs(o);return Us(e,n)});var Bn=class{constructor(n){this.siteId=n;h(this,"name","OnPageEngine");h(this,"sandboxUpdateGenerator",new On(this));h(this,"performanceTracker",new Nn);h(this,"scheduler",new un(this));h(this,"stores");this.stores=new kn(this,this.scheduler,n),this.stores.projectStore.getProject().then(e=>{u(this.stores.assetStore.assetService,"assetsService must be initialized"),Oa(this,this.stores.assetStore.assetService,this.stores.projectStore.filePickerRef),wa(e.api,this.stores.assetStore.assetService),this.stores.modulesStore.initialize().catch(ee),e.connection.on("connect",t=>{t&&this.stores.modulesStore.refresh().catch(ee)})})}get tree(){return this.stores.treeStore.tree}startHighlightTool(){this.stores.toolStore.tool=new ve(this)}startComponentInstanceEditTool(n,e){this.stores.toolStore.tool=new De(this,n,e)}startDateVariableEditTool(n,e,t){this.stores.toolStore.tool=new Me(this,n,e,t)}startCollectionReferenceVariableEditTool(n,e,t){this.stores.toolStore.tool=new Re(this,n,e,t)}startEnumVariableEditTool(n,e,t){this.stores.toolStore.tool=new _e(this,n,e,t)}startImageEditTool(n,e){this.stores.toolStore.tool=new Ve(this,n,e)}startRichTextEditTool(n,e,t){this.stores.toolStore.tool=new Ce(this,n,e,t)}startRichTextVariableEditTool(n,e,t){this.stores.toolStore.tool=new Fe(this,n,e,t)}startStringVariableEditTool(n,e,t){this.stores.toolStore.tool=new Se(this,n,e,t)}exitTool(){this.startHighlightTool()}onChangeRoute(){this.stores.editableNodeHighlightStore.onChangeRoute(),this.exitTool()}getStateToken(){return this.stores.undoRedoManager.getUndoBufferSize()}undo(){let{undoRedoManager:n,toolStore:e,projectStore:t}=this.stores;e.tool?.undo?e.tool.undo():n.peekUndo()&&(n.undo(this.tree),t.commitTreeAndSend(!1))}redo(){let{undoRedoManager:n,toolStore:e,projectStore:t}=this.stores;e.tool?.redo?e.tool.redo():n.peekRedo()&&(n.redo(this.tree),t.commitTreeAndSend(!1))}beginUndoGroup(){this.stores.undoRedoManager.beginUndoGroup()}endUndoGroup(){this.stores.undoRedoManager.scheduleEndUndoGroup()}};var st=g(x());Hr({enableFontStore:!0,fetchGoogleFontsList:Ja,fetchFontshareFontsList:Ha,fetchBuiltInFontsList:ja});async function BF(o,n){let e=new Bn(n);await e.stores.accessStore.set(o),e.stores.sandboxStore.loadSandbox(),Va(e.stores.assetStore.assetMap),Je.importFramerFonts(mi),ka(),Object.assign(window,{engine:e,componentLoader:Q}),Ya((0,st.jsx)(Pi.Provider,{value:e,children:(0,st.jsx)(ps,{forceDarkMode:!0,children:(0,st.jsx)(Ji,{mode:"onPageEditing",children:(0,st.jsxs)(nl,{children:[(0,st.jsx)(Bf,{}),(0,st.jsx)(_s,{})]})})})}),document.getElementById("root"))}export{BF as renderEditorBar};
//# sourceMappingURL=https://app.framerstatic.com/render-SLLQJIRR.mjs.map
