import{g as E,h as ke,j as Ne}from"https://app.framerstatic.com/chunk-NWXZUV7M.mjs";import{Wc as xe,kc as De,vc as Te}from"https://app.framerstatic.com/chunk-N6T5M2U2.mjs";import{Qh as Ve}from"https://app.framerstatic.com/chunk-EBH5X5S4.mjs";import{$c as de,Aq as Ce,Bi as me,Ei as q,Fq as ge,Ke as pe,Kt as Re,Mu as Ie,Op as _,Pc as y,Pp as G,Qq as he,Rq as be,Sq as X,Tq as Y,Wp as ye,Yc as ce,co as Q,ec as T,ed as ue,gi as W,jq as K,ki as fe,kq as ve,lb as D,lc as H,lo as U,nq as $,oq as J,pc as j,pr as Se,u as I}from"https://app.framerstatic.com/chunk-WDCEA3EQ.mjs";import{s as oe}from"https://app.framerstatic.com/chunk-XFCQREKZ.mjs";import{p as A}from"https://app.framerstatic.com/chunk-3DFADFT7.mjs";import{a as O,b as P,d as V,e as z,f as ae,i as f,l as L,o as se,r as le}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{u as ie}from"https://app.framerstatic.com/chunk-IZV4HDYJ.mjs";import{a as m,b as R}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as ne}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{j as B}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var ze=ie("initializeAssetResolver"),x,Z;function rt(e){if(x)throw new Error("initializeAssetResolver() should only be called once");return ze.debug("initializeAssetResolver",{assetMap:e}),x=oe(ne().userContent,e),Z=e,x}function He(){if(x===void 0)throw new Error("getAssetResolver() should not be called before initializeAssetResolver()");return x}function nt(){if(Z===void 0)throw new Error("getCurrentAssetMapHash() should not be called before initializeAssetResolver()");let e=He(),t=Z.hash;return{assetResolver:e,assetMapHash:t}}function je(){I.frame.addScope("is-hidden",1500),I.component.addScope("is-hidden",1500)}function Be(){I.frame.removeScope("is-hidden"),I.component.removeScope("is-hidden")}function ee(e,t,n){if(f(e.hidden))return!1;if(O(e.hidden))return e.hidden;try{je();let s=e.hidden(t,n);return Be(),s}catch{return Be(),!1}}var Oe=class{constructor(t){this.engine=t}async requestHiddenStateForComponentControls(t){let n=t.args,s=this.engine.tree,r={};return Object.entries(n).forEach(([i,{controlNames:a}])=>{let o=s.getNode(i);if(!o)return;m(Se(o),"Node is not a CanvasNode with control props (node.__class: ",o.__class,")");let l=o.getControlPropSourceIdentifier();m(l,"Cannot find component identifier for node");let c=D.reactComponentForIdentifier(l);if(!c||!c.properties)return;let d=a??Object.keys(c.properties),v=o.getResolvedControlPropValues(D);r[i]=Pe(d,c,v)}),{hiddenControlsByNodeId:r}}async requestHiddenStateForActionControls(t){let{actionIdentifier:n,controlNames:s,actionProps:r}=t;m(n,"Fail to request hidden state for action controls: missing actionIdentifier");let i=D.componentForIdentifier(n);return{hiddenState:s.reduce((o,l)=>{let c=i?i.properties[l]:void 0;return c?(o[l]=ee(c,r,r),o):(o[l]=!1,o)},{})}}async requestHiddenStateForModuleControls(t){let n=D.reactComponentForIdentifier(t.moduleIdentifier);return n?.properties?{hiddenState:Pe(t.controlNames??Object.keys(n.properties),n,t.moduleProps)}:{hiddenState:{}}}};function te(e,t,n,s,r,i){let a=e+t;if(n){if(n.hidden&&(i[a]=ee(n,s,r)),n.type==="object"){let o=s[t];if(!z(o))return;for(let l in n.controls){let c=n.controls[l];te(a+".",l,c,o,r,i)}}if(n.type==="array"&&n.control.type==="object"){let o=s[t];if(!ae(o))return;let l=o.length;for(let c=0;c<l;c++){let d=o[c];if(z(d))for(let v in d){let b=n.control.controls[v];te(a+`[${c}].`,v,b,d,r,i)}}}}}function Pe(e,t,n){let s={};for(let r of e){let i=t.properties[r];te("",r,i,n,n,s)}return s}var Le=class{constructor(t){this.environment=t;B(this,"visibleRenderIds",new Set);B(this,"addedRenderIds",new Set);B(this,"removedRenderIds",new Set)}setVisible(t,n){m(this.environment==="sandbox","Setting data is only allowed in the sandbox.");let s=this.getVisible(t);n!==s&&(n?(this.visibleRenderIds.add(t),this.addedRenderIds.add(t),this.removedRenderIds.delete(t)):(this.visibleRenderIds.delete(t),this.removedRenderIds.add(t),this.addedRenderIds.delete(t)))}import(t){m(this.environment==="editor","Importing data is only allowed in the editor.");let n=new Set;for(let s of t.addedRenderIds)this.visibleRenderIds.add(s),n.add(s);for(let s of t.removedRenderIds)this.visibleRenderIds.delete(s),n.add(s);return n}getVisible(t){return this.visibleRenderIds.has(t)}export(){m(this.environment==="sandbox","No need to collect and send updates from within the editor.");let t=Array.from(this.addedRenderIds),n=Array.from(this.removedRenderIds);return this.addedRenderIds.clear(),this.removedRenderIds.clear(),{addedRenderIds:t,removedRenderIds:n}}};function Ae(e,t,n){if(!e||!de(e)){t.cache.parentDirected=void 0;return}t.cache.parentDirected=e.layout,ue(e)&&(t.cache.parentDirectedRowHeightFitContent=e.gridRowHeightType==="fit",t.cache.parentDirectedColumnCount=V(e.gridColumnCount)?e.gridColumnCount:void 0),y(e.stackDirection)&&n?t.cache.parentDirection=e.resolveValue("stackDirection")??ce:t.cache.parentDirection=e.stackDirection??null,pe(e)&&(t.cache.parentWidthType=e.widthType,t.cache.parentHeightType=e.heightType)}function Rt(e,t){Ae(e,t,!1)}function It(e,t){Ae(e,t,!0)}function kt(e,t){let n=Ce(ge),s=A.isOn("pasteMarkdown")?X(e,n):Y(e,{supportsStyles:!0}),r={},i=[],a=[],o=[],l=[];s.doc.descendants(u=>{if(_(u)){let p={blockStyles:u.attrs.blockStyles,inlineStyles:u.attrs.inlineStyles,textStylePreset:u.attrs.textStylePreset},S=r[u.attrs.tag]??[];S.push(p),r[u.attrs.tag]=S}if(G(u)){let p=!1,S=!1,g,h;for(let C of u.marks)p||=$(C),S||=J(C),ye(C)&&(h??=C.attrs),K(C)&&i.push(C.attrs.linkStylePreset),ve(C)&&(g=C.attrs.inlineStyles);l.push(h),p&&a.push(g),S&&o.push(g)}});let c=A.isOn("pasteMarkdown")?X(t,n):Y(t,{supportsStyles:!0}),d=c.tr,v=new Map;c.doc.descendants((u,p,S)=>{if(_(u)){let g=r[u.attrs.tag]??[],h=g.length>1?g.shift():g[0];h&&(v.set(u,h.inlineStyles),d.setNodeMarkup(p,u.type,{...u.attrs,...h}))}if(G(u)){let g=!1,h=!1,C=S?v.get(S):void 0;for(let N of u.marks)if(g||=$(N),h||=J(N),K(N)){let Me=i.length>1?i.shift():i[0];d.addMark(p,p+u.nodeSize,n.marks.link.create({...N.attrs,linkStylePreset:Me}))}g&&(C=a.length>1?a.shift():a[0]),h&&(C=o.length>1?o.shift():o[0]),C&&d.addMark(p,p+u.nodeSize,n.marks.inlineStyles.create({inlineStyles:C}));let re=l.length>1?l.shift():l[0];re&&d.addMark(p,p+u.nodeSize,n.marks.backgroundMask.create(re))}});let b=c.apply(d);return A.isOn("pasteMarkdown")?he(b.doc,n):be(b.doc,!0)}function We(e){if(W(e))return e.type===void 0?e:{...e,type:void 0,value:xe(e.value)}}function qe(e,t){if(W(e))return e.type==="rich-text"?e:{...e,type:"rich-text",value:Te(t,e.value)}}function At(e,t,n){switch(e){case"text":return We(t);case"rich-text":return qe(t,n);default:R(e)}}function Qe(e){return e.originalid??e.id}function F(e,t,n){return m(t==="boolean","Unsupported enum output type:",t),O(e)||T(e)?n(e):{type:"LiteralValue",value:U(t,void 0)}}function Ue(e,t,n,s){function r(i){return T(i)?s(i):{type:"LiteralValue",value:i}}switch(m(H(e.name),`Transform is not a valid expression: ${e.name}`),e.name){case"contains":switch(n?.type){case"multicollectionreference":return{type:"BinaryOperation",operator:"in",left:r(e.value),right:t};default:return{type:"FunctionCall",functionName:"CONTAINS",arguments:[t,r(e.value)]}}case"startsWith":return{type:"FunctionCall",functionName:"STARTS_WITH",arguments:[t,r(e.value)]};case"endsWith":return{type:"FunctionCall",functionName:"ENDS_WITH",arguments:[t,r(e.value)]};case"equals":return{type:"BinaryOperation",operator:"==",left:t,right:r(e.value)};case"isSet":{let i={type:"BinaryOperation",operator:"!=",left:t,right:{type:"LiteralValue",value:null}};return n?.type==="multicollectionreference"||n?.type==="array"?{type:"BinaryOperation",operator:"and",left:i,right:{type:"BinaryOperation",operator:">",left:{type:"FunctionCall",functionName:"LENGTH",arguments:[t]},right:{type:"LiteralValue",value:0}}}:{type:"BinaryOperation",operator:"and",left:i,right:{type:"BinaryOperation",operator:"!=",left:t,right:{type:"LiteralValue",value:""}}}}case"greaterThan":return{type:"BinaryOperation",operator:">",left:t,right:r(e.value)};case"lessThan":return{type:"BinaryOperation",operator:"<",left:t,right:r(e.value)};case"negate":return{type:"UnaryOperation",operator:"not",value:t};case"toBoolean":return{type:"TypeCast",dataType:"BOOLEAN",value:t};case"isBefore":return{type:"BinaryOperation",operator:"<=",left:{type:"TypeCast",dataType:"DATE",value:t},right:{type:"TypeCast",dataType:"DATE",value:r(e.value)}};case"isAfter":return{type:"BinaryOperation",operator:">=",left:{type:"TypeCast",dataType:"DATE",value:t},right:{type:"TypeCast",dataType:"DATE",value:r(e.value)}};case"isBetweenDates":return{type:"BinaryOperation",operator:"and",left:{type:"BinaryOperation",operator:">=",left:{type:"TypeCast",dataType:"DATE",value:t},right:{type:"TypeCast",dataType:"DATE",value:r(e.start)}},right:{type:"BinaryOperation",operator:"<=",left:{type:"TypeCast",dataType:"DATE",value:t},right:{type:"TypeCast",dataType:"DATE",value:r(e.end)}}};case"isIncludedIn":return{type:"BinaryOperation",operator:"in",left:t,right:r(e.value)};case"convertFromEnum":{if(n?.type!=="enum")return{type:"LiteralValue",value:U(e.outputType,void 0)};let i=new Set,a=[];for(let o of e.cases)i.has(o.from)||n.options.includes(o.from)&&(i.add(o.from),a.push({type:"Condition",when:{type:"LiteralValue",value:o.from},then:F(o.to,e.outputType,r)}));return{type:"Case",value:t,conditions:a,else:F(e.default,e.outputType,r)}}case"convertFromString":{let i=new Set,a=[];for(let o of e.cases)i.has(o.from)||(i.add(o.from),a.push({type:"Condition",when:{type:"LiteralValue",value:o.from},then:F(o.to,e.outputType,r)}));return{type:"Case",value:t,conditions:a,else:F(e.default,e.outputType,r)}}default:R(e.name)}}function _e(e,t,n,s,r,i){if(!e.collectionFilters)return;let a=e.collectionFilters.filters,o=e.collectionFiltersOperator??Ve,l;for(let{itemKey:c,transforms:d}of a){if(!c)continue;let v=t.get(c);if(!v||(n.add(c),v.type!=="boolean"&&d.length===0))continue;let b=d.some(p=>{if(!j(p.name)||!H(p.name))return!1;switch(p.name){case"convertFromEnum":case"convertFromString":case"endsWith":case"equals":case"greaterThan":case"isAfter":case"isBefore":case"isBetweenDates":case"isSet":case"lessThan":case"negate":case"startsWith":case"toBoolean":return!0;case"contains":case"isIncludedIn":return!T(p.value);default:R(p.name)}}),u=M(c,v,n,s,i,b);for(let p of d)j(p.name)&&(u=Ue(p,u,v,r));l=l?{type:"BinaryOperation",operator:o==="all"?"and":"or",left:l,right:u}:u}return l}function Ge(e,t,n,s,r,i){if(e.collectionOrder&&e.collectionOrder.length>0){let a=[];for(let{itemKey:o,direction:l}of e.collectionOrder){if(!o)continue;let c=t.get(o);if(!c)continue;let d=M(o,c,n,s,i);l==="desc"&&(d.direction="desc"),a.push(d)}return a}if(e.collectionFilters&&e.collectionFilters.filters.length===1){let a=e.collectionFilters.filters.at(0);if(m(a,"filter should exist"),a.itemKey){let o=t.get(a.itemKey),l=M(a.itemKey,o,n,s,i),c=Ke(e,a.transforms,l,o,r);if(c)return[c]}}return e.collectionReverse?[{type:"Identifier",name:"index",collection:s,direction:"desc"}]:[]}function Ke(e,t,n,s,r){if(t.length!==1||s?.type!=="collectionreference")return;let i=t[0];if(m(i,"Transform must exist"),i.name==="isIncludedIn"&&T(i.value))return{type:"FunctionCall",functionName:"INDEX_OF",arguments:[r(i.value),n],direction:e.collectionReverse?"desc":"asc"}}function $e(e,t,n,s,r){let i={type:"Collection",data:r(e),alias:s},a=new Map;for(let o of n){let l=o.split(".");for(let c=1;c<l.length;c++){let d=l.slice(0,c).join("."),v=t.get(d);if(v?.type!=="collectionreference")continue;let b=v.dataIdentifier;a.set(d,b)}}for(let[o,l]of a){let[c,d]=Ee(o,s);i={type:"LeftJoin",left:i,right:{type:"Collection",data:r(l),alias:o},constraint:{type:"BinaryOperation",operator:"==",left:{type:"Identifier",name:d,collection:c},right:{type:"Identifier",name:"id",collection:o}}}}return i}function Je(e,t,n,s,r){let i=[];for(let a of t){if(Re(a))continue;let o=e.get(a),l=M(a,o,n,s,r);(l.type!=="Identifier"||a!==l.name)&&(l.alias=a),i.push(l)}return i}function Xt(e,t,n,s,r){let i={},a=new Set,o=Qe(e);e.collectionFilters&&(i.where=_e(e,t,a,o,s,r));let l=Ge(e,t,a,o,s,r);l.length>0&&(i.orderBy=l),V(e.collectionStartOffset)&&(i.offset={type:"LiteralValue",value:e.collectionStartOffset}),V(e.collectionLimit)&&(i.limit={type:"LiteralValue",value:e.collectionLimit});let c=Je(t,n,a,o,r);return{from:$e(e.dataIdentifier,t,a,o,r),select:c,...i}}function M(e,t,n,s,r,i=!0){i&&t?.type==="collectionreference"&&!Ie(e)&&(e+=".id"),n.add(e);let[a,o]=Ee(e,s);return i&&t?.type==="multicollectionreference"?{type:"FunctionCall",functionName:"FLAT_ARRAY",arguments:[{type:"Select",from:{type:"Collection",data:r(t.dataIdentifier),alias:e},select:[{type:"Identifier",name:"id",collection:e}],where:{type:"BinaryOperation",operator:"in",left:{type:"Identifier",name:"id",collection:e},right:{type:"Identifier",name:o,collection:a}},orderBy:[{type:"FunctionCall",functionName:"INDEX_OF",arguments:[{type:"Identifier",name:o,collection:a},{type:"Identifier",name:"id",collection:e}]}]}]}:{type:"Identifier",name:o,collection:a}}function Ee(e,t){let n=e.split(".");if(n.length===1)return[t,e];let s=n.slice(0,-1).join("."),r=n.slice(-1).join(".");return[s,r]}function nr(e){let t=new Map;for(let n of e)n.type!=="divider"&&t.set(n.id,n);return t}function Xe(e,t,n,s,r,i){if(t.type!=="string"||P(n?.value))return;let a=s.get(e);if(a?.type!=="string"||a.fallbackValue!=="associatedVariable")return;let o=a.associatedStringVariable;if(se(o))return;let l=i.getControlProp(o),c=r[o];if(f(c))return;let d=Q(c,l);if(d?.type==="string")return d}function ir(e,t,n,s,r){let i=r.getControlProp(e),o=Xe(e,t,i,n,s,r)??Q(t,i);if(Ne(o))return o}function we({control:e,controlProp:t,resolvers:n,locale:s}){switch(t.type){case"array":{m(e.type==="array","Invalid control");let{value:r}=t;if(y(r))return;let i=r.map(a=>we({control:e.control,controlProp:a,resolvers:n,locale:s})??null);return{type:"array",value:i}}case"boolean":{let{value:r}=t;return y(r)?void 0:{type:"boolean",value:r}}case"collectionreference":{let{value:r}=t;return y(r)||f(r)?void 0:{type:"string",value:r}}case"color":{let{value:r}=t;if(y(r)||L(r))return;let i=n.resolveColor(r);return f(i)?void 0:{type:"color",value:i}}case"date":{m(e.type==="date","Invalid control");let{value:r}=t;if(y(r)||f(r))return;let i=new Date(r);return le(i)?(e.displayTime||i.setUTCHours(0,0,0,0),{type:"date",value:i.toISOString()}):void 0}case"enum":{let{value:r}=t;return y(r)||f(r)?void 0:(m(P(r),"Enum is not a string"),{type:"enum",value:r})}case"file":{let{value:r}=t;if(y(r)||f(r))return;let i=n.resolveFile(r);return f(i)?void 0:{type:"file",value:i}}case"image":{let r=k(e,t.valueLocalized,s),i=r?.value??t.value;if(y(i)||f(i))return;let a=r?.imageFocalPoint??t,o=n.resolveImage(i,a);if(f(o))return;let c=k(e,t.altLocalized,s)?.value??t.alt;return{type:"responsiveimage",value:{...o,alt:c}}}case"link":{let r=q(t.value);if(me(r)){let a=k(e,t.valueLocalized,s);a?.value&&(r=q(a.value))}if(y(r)||f(r))return;let i=n.resolveLink(r);return f(i)?void 0:{type:"link",value:i}}case"multicollectionreference":{let{value:r}=t;return y(r)||f(r)?void 0:{type:"array",value:r.map(i=>({type:"string",value:i}))}}case"number":{let{value:r}=t;return y(r)?void 0:{type:"number",value:r}}case"object":{m(e.type==="object","Invalid control");let{value:r}=t;if(y(r)||L(r))return;let i=De(e.controls,(a,o)=>{let l=r[a];return l?we({control:o,controlProp:l,resolvers:n,locale:s})??null:null});return fe(t)&&(i[E]={type:"string",value:t.id}),{type:"object",value:i}}case"richtext":{let i=k(e,t.valueLocalized,s)?.value??t.value;if(y(i)||ke(i))return;let a=n.resolveRichTextPointer(i);return f(a)?void 0:{type:"richtext",value:a}}case"string":{let i=k(e,t.valueLocalized,s)?.value??t.value;return y(i)?void 0:{type:"string",value:i}}case"vectorsetitem":{let{value:r}=t;if(y(r)||f(r))return;let i=n.resolveVectorSetItemPointer(r);return f(i)?void 0:{type:"vectorsetitem",value:i}}default:}}function k(e,t,n){if(!(!t||!n||Ze(e)))for(;n;){let r=t[n.id];if(r&&!L(r.value))return r;n=n.fallback}}function Ze(e){return"preventLocalization"in e?e.preventLocalization??!1:!1}function Fe(e,t=n=>n){switch(e.type){case"array":{let n=Fe(e.control,t);return n.definitions[E]={type:t("string"),isNullable:!1},{type:t("array"),isNullable:!0,definition:n}}case"boolean":case"color":case"date":case"enum":case"file":case"link":case"number":case"richtext":case"string":return{type:t(e.type),isNullable:!0};case"collectionreference":return{type:t("string"),isNullable:!0};case"image":case"responsiveimage":return{type:t("responsiveimage"),isNullable:!0};case"multicollectionreference":return{type:t("array"),isNullable:!0,definition:{type:t("string"),isNullable:!0}};case"object":{let n=Object.entries(e.controls),s={};for(let[r,i]of n){let a=Fe(i,t);a&&(s[r]=a)}return{type:t("object"),isNullable:!0,definitions:s}}case"vectorsetitem":return{type:t("vectorsetitem"),isNullable:!0};default:}}export{Oe as a,Le as b,nr as c,ir as d,we as e,Fe as f,Rt as g,It as h,kt as i,We as j,qe as k,At as l,Qe as m,$e as n,Je as o,Xt as p,Ee as q,rt as r,He as s,nt as t};
//# sourceMappingURL=https://app.framerstatic.com/chunk-CFPWEMX5.mjs.map
