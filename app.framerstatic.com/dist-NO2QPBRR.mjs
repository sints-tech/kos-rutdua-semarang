import{p,y as f}from"https://app.framerstatic.com/chunk-4DUBS6C5.mjs";import"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";function w(a={}){return new f({view(t){return new h(t,a)}})}var h=class{constructor(t,e){var i;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(i=e.width)!==null&&i!==void 0?i:1,this.color=e.color===!1?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map(o=>{let l=r=>{this[o](r)};return t.dom.addEventListener(o,l),{name:o,handler:l}})}destroy(){this.handlers.forEach(({name:t,handler:e})=>this.editorView.dom.removeEventListener(t,e))}update(t,e){this.cursorPos!=null&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),e=!t.parent.inlineContent,i;if(e){let s=t.nodeBefore,c=t.nodeAfter;if(s||c){let u=this.editorView.nodeDOM(this.cursorPos-(s?s.nodeSize:0));if(u){let d=u.getBoundingClientRect(),n=s?d.bottom:d.top;s&&c&&(n=(n+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),i={left:d.left,right:d.right,top:n-this.width/2,bottom:n+this.width/2}}}}if(!i){let s=this.editorView.coordsAtPos(this.cursorPos);i={left:s.left-this.width/2,right:s.left+this.width/2,top:s.top,bottom:s.bottom}}let o=this.editorView.dom.offsetParent;this.element||(this.element=o.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",e),this.element.classList.toggle("prosemirror-dropcursor-inline",!e);let l,r;if(!o||o==document.body&&getComputedStyle(o).position=="static")l=-pageXOffset,r=-pageYOffset;else{let s=o.getBoundingClientRect();l=s.left-o.scrollLeft,r=s.top-o.scrollTop}this.element.style.left=i.left-l+"px",this.element.style.top=i.top-r+"px",this.element.style.width=i.right-i.left+"px",this.element.style.height=i.bottom-i.top+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),i=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),o=i&&i.type.spec.disableDropCursor,l=typeof o=="function"?o(this.editorView,e,t):o;if(e&&!l){let r=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let s=p(this.editorView.state.doc,r,this.editorView.dragging.slice);s!=null&&(r=s)}this.setCursor(r),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){(t.target==this.editorView.dom||!this.editorView.dom.contains(t.relatedTarget))&&this.setCursor(null)}};export{w as dropCursor};
//# sourceMappingURL=https://app.framerstatic.com/dist-NO2QPBRR.mjs.map
